<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KUN 0X Nexus | Command Center</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        nexus: {
                            900: '#0f172a',
                            800: '#1e293b',
                            700: '#334155',
                            500: '#3b82f6',
                            400: '#60a5fa',
                            accent: '#10b981'
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Vue.js 3 (Local + CDN Fallback) -->
    <script src="/static/js/vue.js"></script>
    <script>
        if (typeof Vue === 'undefined') {
            console.warn('Local Vue.js not found, falling back to CDN');
            document.write('<script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"><\/script>');
        }
    </script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Prism.js for Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');
        body { font-family: 'JetBrains Mono', monospace; }
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .scroll-smooth::-webkit-scrollbar { width: 8px; }
        .scroll-smooth::-webkit-scrollbar-track { background: #0f172a; }
        .scroll-smooth::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        [v-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-nexus-900 text-gray-200 min-h-screen flex flex-col">

    <div id="app" v-cloak class="flex flex-1 h-screen overflow-hidden">
        <div v-if="sidebarOpen" class="fixed inset-0 bg-black/60 z-30 md:hidden" @click="sidebarOpen = false"></div>
        
        <!-- Sidebar -->
        <aside :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'" class="w-64 bg-nexus-800 border-r border-nexus-700 flex flex-col z-40 fixed inset-y-0 left-0 transform transition-transform duration-200 ease-in-out md:relative md:translate-x-0">
            <div class="p-6 flex items-center gap-3 border-b border-nexus-700">
                <div class="w-8 h-8 bg-nexus-500 rounded-lg flex items-center justify-center shadow-lg shadow-blue-500/20">
                    <i data-lucide="cpu" class="text-white w-5 h-5"></i>
                </div>
                <h1 class="text-xl font-bold tracking-wider text-white">KUN 0X NEXUS</h1>
            </div>
            
            <nav class="flex-1 p-4 space-y-2">
                <button @click="currentTab = 'dashboard'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'dashboard'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="layout-dashboard" class="w-5 h-5"></i> {{ t('dashboard') }}
                </button>
                <button @click="currentTab = 'games'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'games'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="gamepad-2" class="w-5 h-5"></i> {{ t('games') }}
                </button>
                <button @click="currentTab = 'users'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'users'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="users" class="w-5 h-5"></i> {{ t('users') }}
                </button>
                <button @click="currentTab = 'logs'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'logs'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="terminal" class="w-5 h-5"></i> {{ t('logs') }}
                </button>
                <button v-if="currentUser?.role === 'admin' || currentUser?.role === 'moderator'" @click="currentTab = 'chat'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'chat'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="messages-square" class="w-5 h-5"></i> {{ t('chat') }}
                </button>
                <button v-if="currentUser" @click="currentTab = 'office'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'office'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="briefcase" class="w-5 h-5"></i> {{ t('office') }}
                </button>
                <button v-if="currentUser" @click="currentTab = 'archive'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'archive'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="archive" class="w-5 h-5"></i> {{ t('archive') }}
                </button>
                <button v-if="currentUser?.role === 'admin'" @click="currentTab = 'finance'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'finance'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="wallet-cards" class="w-5 h-5"></i> {{ t('finance') }}
                </button>
                <button v-if="currentUser?.role === 'admin'" @click="currentTab = 'admin'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'admin'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="shield-alert" class="w-5 h-5"></i> {{ t('admin') }}
                </button>
                <button v-if="currentUser?.role === 'admin'" @click="currentTab = 'bot_mgmt'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'bot_mgmt'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="bot" class="w-5 h-5"></i> {{ t('bot_management') }}
                </button>
                <button v-if="currentUser?.role === 'admin'" @click="currentTab = 'store'; sidebarOpen = false" :class="{'bg-nexus-700 text-white': currentTab === 'store'}" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-nexus-700 hover:text-white transition-all">
                    <i data-lucide="shopping-bag" class="w-5 h-5"></i> ŸÖÿ™ÿ¨ÿ±
                </button>
            </nav>
            
            <div class="p-4 border-t border-nexus-700 space-y-4">
                <!-- Lang Switcher -->
                <div class="flex bg-nexus-900 rounded-lg p-1 border border-nexus-700">
                    <button @click="setLang('en')" :class="currentLang === 'en' ? 'bg-nexus-700 text-white' : 'text-gray-400'" class="flex-1 py-1 rounded text-xs font-bold transition-all">EN</button>
                    <button @click="setLang('ar')" :class="currentLang === 'ar' ? 'bg-nexus-700 text-white' : 'text-gray-400'" class="flex-1 py-1 rounded text-xs font-bold transition-all">AR</button>
                </div>

                <!-- User Profile -->
                <div v-if="currentUser" class="flex items-center justify-between gap-2">
                    <div class="flex items-center gap-2 overflow-hidden">
                        <div class="w-8 h-8 rounded-full bg-nexus-500 flex items-center justify-center text-xs font-bold text-white">
                            {{ currentUser.username.substring(0, 2).toUpperCase() }}
                        </div>
                        <div class="flex flex-col truncate">
                            <span class="text-xs font-bold text-white truncate">{{ currentUser.username }}</span>
                            <span class="text-[10px] text-gray-400 uppercase">{{ currentUser.role }}</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-1">
                        <button @click="showChangePasswordModal = true" class="text-gray-400 hover:text-white transition-colors" :title="t('change_password')">
                            <i data-lucide="key" class="w-4 h-4"></i>
                        </button>
                        <button @click="logout" class="text-gray-400 hover:text-red-400 transition-colors" :title="t('logout')">
                            <i data-lucide="log-out" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>

                <div class="flex items-center gap-3 text-sm text-gray-400 pt-2 border-t border-nexus-700/50">
                    <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                    {{ t('system_online') }}
                </div>
                <div class="text-[10px] text-center text-gray-500 mt-2 pt-2 border-t border-nexus-700/30">
                    By: Kun Academy | 0x Matrix
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto relative scroll-smooth">
            <div class="md:hidden sticky top-0 z-20 bg-nexus-900/90 backdrop-blur border-b border-nexus-700 p-3 flex items-center gap-3">
                <button @click="sidebarOpen = true" class="p-2 bg-nexus-800 hover:bg-nexus-700 rounded-lg">
                    <i data-lucide="menu" class="w-5 h-5"></i>
                </button>
                <div class="text-sm font-bold text-white truncate">KUN 0X NEXUS</div>
            </div>
            
            <!-- Dashboard View -->
            <div v-if="currentTab === 'dashboard'" class="p-4 md:p-8 space-y-8">
                <header class="flex justify-between items-center mb-8">
                    <div>
                        <h2 class="text-3xl font-bold text-white">Command Center</h2>
                        <p class="text-gray-400 mt-1">Real-time system overview</p>
                    </div>
                    <button @click="fetchStats" class="p-2 bg-nexus-700 rounded-lg hover:bg-nexus-600"><i data-lucide="refresh-cw" class="w-5 h-5"></i></button>
                </header>

                <!-- Stats Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="glass p-6 rounded-xl border border-nexus-700 relative overflow-hidden group">
                        <div class="absolute -right-6 -top-6 w-24 h-24 bg-blue-500/10 rounded-full group-hover:scale-110 transition-transform"></div>
                        <h3 class="text-gray-400 text-sm font-medium">Total Users</h3>
                        <p class="text-4xl font-bold text-white mt-2">{{ stats.users }}</p>
                    </div>
                    <div class="glass p-6 rounded-xl border border-nexus-700 relative overflow-hidden group">
                        <div class="absolute -right-6 -top-6 w-24 h-24 bg-purple-500/10 rounded-full group-hover:scale-110 transition-transform"></div>
                        <h3 class="text-gray-400 text-sm font-medium">Active Games</h3>
                        <p class="text-4xl font-bold text-white mt-2">{{ stats.games?.active }} <span class="text-sm text-gray-500">/ {{ stats.games?.total }}</span></p>
                    </div>
                    <div class="glass p-6 rounded-xl border border-nexus-700 relative overflow-hidden group">
                        <div class="absolute -right-6 -top-6 w-24 h-24 bg-green-500/10 rounded-full group-hover:scale-110 transition-transform"></div>
                        <h3 class="text-gray-400 text-sm font-medium">Events (24h)</h3>
                        <p class="text-4xl font-bold text-nexus-accent mt-2">{{ stats.events?.last_24h }}</p>
                    </div>
                    <div class="glass p-6 rounded-xl border border-nexus-700 relative overflow-hidden group">
                        <div class="absolute -right-6 -top-6 w-24 h-24 bg-red-500/10 rounded-full group-hover:scale-110 transition-transform"></div>
                        <h3 class="text-gray-400 text-sm font-medium">System Load</h3>
                        <p class="text-4xl font-bold text-white mt-2">Low</p>
                    </div>
                </div>

                <div class="glass rounded-xl p-6 border border-nexus-700 mt-8">
                    <h3 class="text-lg font-bold text-white flex items-center gap-2">
                        <i data-lucide="bar-chart-2" class="w-5 h-5 text-nexus-400"></i> {{ t('platform_stats_title') }}
                    </h3>
                    <div class="mt-4 overflow-x-auto">
                        <table class="w-full text-left text-sm">
                            <thead class="text-gray-400 border-b border-nexus-700">
                                <tr>
                                    <th class="py-2 pr-4">{{ t('platform') }}</th>
                                    <th class="py-2 pr-4 text-right">{{ t('platform_events') }}</th>
                                    <th class="py-2 pr-4 text-right">{{ t('platform_success') }}</th>
                                    <th class="py-2 pr-4 text-right">{{ t('platform_success_rate') }}</th>
                                </tr>
                            </thead>
                            <tbody class="text-gray-300 divide-y divide-nexus-800">
                                <tr v-for="(info, name) in stats.platforms" :key="name">
                                    <td class="py-2 pr-4 font-mono text-xs text-gray-300">{{ name }}</td>
                                    <td class="py-2 pr-4 text-right">{{ info.total }}</td>
                                    <td class="py-2 pr-4 text-right text-green-400">{{ info.success }}</td>
                                    <td class="py-2 pr-4 text-right">
                                        <span class="font-mono text-xs">
                                            {{ info.total ? ((info.success / info.total) * 100).toFixed(1) : '0.0' }}%
                                        </span>
                                    </td>
                                </tr>
                                <tr v-if="!stats.platforms || Object.keys(stats.platforms).length === 0">
                                    <td class="py-3 text-gray-500 text-sm" colspan="4">{{ t('no_results') }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Platform Management -->
                <div class="glass rounded-xl p-6 border border-nexus-700 mb-8">
                    <h3 class="text-lg font-bold text-white flex items-center gap-2 mb-6"><i data-lucide="settings" class="w-5 h-5 text-nexus-400"></i> {{ t('platform_settings') }}</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div v-for="(enabled, key) in platformSettings" :key="key" class="bg-nexus-900/50 p-4 rounded-lg border border-nexus-700 flex justify-between items-center">
                            <div>
                                <h4 class="font-bold text-white">{{ key }}</h4>
                                <p class="text-xs text-gray-400">{{ enabled ? 'Active' : 'Inactive' }}</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" v-model="platformSettings[key]" @change="savePlatformSettings" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div class="flex justify-between items-center">
                            <h4 class="font-bold text-white text-sm">{{ t('change_logs') }}</h4>
                            <button @click="fetchChangelogs" class="text-xs bg-nexus-800 hover:bg-nexus-700 p-1 rounded"><i data-lucide="refresh-cw" class="w-3 h-3"></i></button>
                        </div>
                        <div class="bg-nexus-900 rounded-lg border border-nexus-700 overflow-hidden max-h-60 overflow-y-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="bg-nexus-800 text-gray-400 sticky top-0">
                                    <tr>
                                        <th class="p-3">{{ t('time') }}</th>
                                        <th class="p-3">{{ t('admin') }}</th>
                                        <th class="p-3">{{ t('action') }}</th>
                                        <th class="p-3">{{ t('details') }}</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-nexus-700">
                                    <tr v-for="log in changelogs" :key="log.id" class="hover:bg-nexus-800/50">
                                        <td class="p-3 font-mono text-gray-400">{{ new Date(log.timestamp).toLocaleString() }}</td>
                                        <td class="p-3 text-blue-400 font-bold">{{ log.editor }}</td>
                                        <td class="p-3 text-white">{{ log.action }}</td>
                                        <td class="p-3 font-mono text-xs text-gray-500 truncate max-w-xs" :title="JSON.stringify(log.details)">{{ JSON.stringify(log.details) }}</td>
                                    </tr>
                                    <tr v-if="changelogs.length === 0">
                                        <td colspan="4" class="p-4 text-center text-gray-500">No changes recorded.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity Table -->
                <div class="glass rounded-xl p-6 border border-nexus-700">
                    <h3 class="text-xl font-bold text-white mb-4">Recent S2S Activity</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead>
                                <tr class="text-gray-400 border-b border-nexus-700">
                                    <th class="pb-3 pl-2">Time</th>
                                    <th class="pb-3">Game</th>
                                    <th class="pb-3">Event</th>
                                    <th class="pb-3">Status</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm">
                                <tr v-for="log in history" :key="log.id" @click="openDetails(log)" class="border-b border-nexus-800 hover:bg-nexus-800/50 transition-colors cursor-pointer">
                                    <td class="py-3 pl-2 font-mono text-gray-400">{{ log.time }}</td>
                                    <td class="py-3 font-medium text-blue-400">{{ log.game }}</td>
                                    <td class="py-3">{{ log.event }}</td>
                                    <td class="py-3">
                                        <span :class="log.status >= 200 && log.status < 300 ? 'text-green-400' : 'text-red-400'">
                                            {{ log.status }}
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Games View -->
            <div v-if="currentTab === 'games'" class="p-4 md:p-8 space-y-6">
                <header class="flex justify-between items-center">
                    <h2 class="text-3xl font-bold text-white">Games Database</h2>
                    <button v-if="currentUser?.role === 'admin'" @click="showAddGameModal = true" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                        <i data-lucide="plus" class="w-4 h-4"></i> {{ t('add_game') }}
                    </button>
                </header>

                <div class="flex gap-4 mb-6">
                    <button @click="filterScope = 'all'" :class="filterScope === 'all' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">{{ t('all') }}</button>
                    <button @click="filterScope = 'global'" :class="filterScope === 'global' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">{{ t('global') }}</button>
                    <button @click="filterScope = 'private'" :class="filterScope === 'private' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">{{ t('private') }}</button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div v-for="game in filteredGames" :key="game.id" class="glass rounded-xl p-5 border border-nexus-700 hover:border-nexus-500 transition-colors">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 bg-nexus-800 rounded-lg flex items-center justify-center text-2xl relative">
                                üéÆ
                                <span v-if="game.owner_id" class="absolute -top-2 -right-2 bg-purple-500 text-xs px-1 rounded shadow" :title="t('private')">üîí</span>
                                <span v-else class="absolute -top-2 -right-2 bg-blue-500 text-xs px-1 rounded shadow" :title="t('global')">üåê</span>
                            </div>
                            <div v-if="currentUser?.role === 'admin'" class="flex gap-2">
                                <button v-if="game.owner_id" @click="promoteGame(game.id)" class="bg-purple-500/20 text-purple-400 px-2 py-1 rounded text-xs font-bold uppercase hover:bg-purple-500/40 transition-colors" :title="t('promote')">
                                    <i data-lucide="upload-cloud" class="w-3 h-3"></i>
                                </button>
                                <button @click="openEditGameModal(game)" class="bg-blue-500/20 text-blue-400 px-2 py-1 rounded text-xs font-bold uppercase hover:bg-blue-500/40 transition-colors">
                                    <i data-lucide="edit-2" class="w-3 h-3"></i>
                                </button>
                                <button @click="deleteGame(game.id)" class="bg-red-500/20 text-red-400 px-2 py-1 rounded text-xs font-bold uppercase hover:bg-red-500/40 transition-colors">
                                    <i data-lucide="trash-2" class="w-3 h-3"></i>
                                </button>
                                <button @click="toggleGame(game.id)" :class="game.is_active ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'" class="px-2 py-1 rounded text-xs font-bold uppercase">
                                    {{ game.is_active ? 'Active' : 'Disabled' }}
                                </button>
                            </div>
                        </div>
                        <h3 class="text-lg font-bold text-white">{{ game.name }}</h3>
                        <p class="text-sm text-gray-400 mb-4">{{ game.provider }}</p>
                        <p v-if="game.owner_id" class="text-xs text-purple-300 mb-2 font-mono">Owner: #{{ game.owner_id }}</p>
                        <div class="flex justify-between items-center text-sm text-gray-500 font-mono bg-nexus-900/50 p-2 rounded mb-2">
                            <span>Key:</span>
                            <span class="text-gray-300">{{ game.alias }}</span>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gray-500 font-mono bg-nexus-900/50 p-2 rounded">
                            <span>Price:</span>
                            <span class="text-green-400 font-bold">${{ game.price || 0 }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Users View -->
            <div v-if="currentTab === 'users'" class="p-4 md:p-8 space-y-6">
                <header class="flex justify-between items-center">
                    <h2 class="text-3xl font-bold text-white">User Management</h2>
                    <div class="flex gap-3">
                        <button @click="showAddBalanceAllModal = true" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                            <i data-lucide="coins" class="w-4 h-4"></i> {{ t('add_balance_all') }}
                        </button>
                        <div class="relative">
                            <input type="text" placeholder="Search users..." class="bg-nexus-900 border border-nexus-700 text-white px-4 py-2 rounded-lg focus:outline-none focus:border-nexus-500 w-64">
                            <i data-lucide="search" class="absolute right-3 top-2.5 text-gray-500 w-4 h-4"></i>
                        </div>
                    </div>
                </header>

                <div class="glass rounded-xl overflow-hidden border border-nexus-700">
                    <table class="w-full text-left">
                        <thead class="bg-nexus-800 text-gray-400">
                            <tr>
                                <th class="p-4">User ID</th>
                                <th class="p-4">Balance</th>
                                <th class="p-4">Proxy</th>
                                <th class="p-4">Last Active</th>
                                <th class="p-4">Status</th>
                                <th class="p-4">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-nexus-700">
                            <tr v-for="user in filteredUsers" :key="user.id" class="hover:bg-nexus-800/50 transition-colors">
                                <td class="p-4 font-mono text-blue-400">#{{ user.id }}</td>
                                <td class="p-4 text-green-400 font-bold">${{ user.balance }}</td>
                                <td class="p-4">
                                    <div class="flex flex-col">
                                        <span :class="user.proxy_enabled ? 'text-green-400' : 'text-gray-500'" class="text-xs font-bold">
                                            {{ user.proxy_enabled ? 'ON' : 'OFF' }}
                                        </span>
                                        <span v-if="user.proxy_enabled" class="text-[10px] text-gray-400 font-mono truncate max-w-[220px]" :title="user.proxy_base">
                                            {{ user.proxy_base }}
                                        </span>
                                        <span v-if="user.proxy_enabled && user.proxy_has_auth" class="text-[10px] text-purple-300">AUTH</span>
                                    </div>
                                </td>
                                <td class="p-4 text-gray-400">{{ user.last_active }}</td>
                                <td class="p-4">
                                    <span v-if="!user.is_banned" class="px-2 py-1 rounded text-xs bg-green-500/20 text-green-400">Active</span>
                                    <span v-else class="px-2 py-1 rounded text-xs bg-red-500/20 text-red-400">Banned</span>
                                </td>
                                <td class="p-4 flex gap-2">
                                    <button @click="openBalanceModal(user)" class="text-nexus-400 hover:text-white" :title="t('add_balance')"><i data-lucide="wallet" class="w-5 h-5"></i></button>
                                    <button v-if="!user.is_banned" @click="banUser(user.id)" class="text-red-400 hover:text-red-300" title="Ban User"><i data-lucide="ban" class="w-5 h-5"></i></button>
                                    <button v-else @click="unbanUser(user.id)" class="text-green-400 hover:text-green-300" title="Unban User"><i data-lucide="check-circle" class="w-5 h-5"></i></button>
                                </td>
                            </tr>
                            <tr v-if="filteredUsers.length === 0">
                                <td colspan="5" class="p-8 text-center text-gray-500">No users found.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Archive View -->
            <div v-if="currentTab === 'archive'" class="p-4 md:p-8 space-y-6">
                <header class="flex justify-between items-center">
                    <h2 class="text-3xl font-bold text-white">{{ t('archive') }}</h2>
                    <button @click="fetchArchive" class="bg-nexus-800 hover:bg-nexus-700 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                        <i data-lucide="refresh-cw" class="w-4 h-4"></i> {{ t('refresh') }}
                    </button>
                </header>

                <div class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                        <input v-model="archiveFilters.q" :placeholder="t('search')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="archiveFilters.user_id" type="number" :placeholder="t('user_id')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="archiveFilters.game" :placeholder="t('game')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="archiveFilters.platform" :placeholder="t('platform')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="archiveFilters.event" :placeholder="t('event')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="archiveFilters.status_code" type="number" :placeholder="t('status')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="archiveFilters.from_ts" type="datetime-local" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="archiveFilters.to_ts" type="datetime-local" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                    </div>
                    <div class="flex justify-end gap-3">
                        <button @click="resetArchiveFilters" class="text-gray-300 hover:text-white text-sm px-4 py-2 rounded border border-nexus-700 hover:border-nexus-500">{{ t('reset') }}</button>
                        <button @click="applyArchiveFilters" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold shadow-lg shadow-blue-500/20">{{ t('apply') }}</button>
                    </div>
                </div>

                <div class="glass rounded-xl overflow-hidden border border-nexus-700">
                    <table class="w-full text-left">
                        <thead class="bg-nexus-800 text-gray-400">
                            <tr>
                                <th class="p-4">{{ t('time') }}</th>
                                <th class="p-4">{{ t('user_id') }}</th>
                                <th class="p-4">{{ t('game') }}</th>
                                <th class="p-4">{{ t('event') }}</th>
                                <th class="p-4">{{ t('platform') }}</th>
                                <th class="p-4">{{ t('status') }}</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-nexus-700">
                            <tr v-for="log in archiveItems" :key="log.id" @click="openDetails(log)" class="hover:bg-nexus-800/50 transition-colors cursor-pointer">
                                <td class="p-4 font-mono text-gray-400">{{ new Date(log.time).toLocaleString() }}</td>
                                <td class="p-4 font-mono text-blue-400">#{{ log.user_id }}</td>
                                <td class="p-4 text-white">{{ log.game }}</td>
                                <td class="p-4 text-gray-300">{{ log.event }}</td>
                                <td class="p-4 text-gray-400 font-mono">{{ log.platform }}</td>
                                <td class="p-4">
                                    <span :class="log.status >= 200 && log.status < 300 ? 'text-green-400' : 'text-red-400'">{{ log.status }}</span>
                                </td>
                            </tr>
                            <tr v-if="archiveItems.length === 0">
                                <td colspan="6" class="p-8 text-center text-gray-500">{{ t('no_results') }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="flex justify-between items-center text-sm text-gray-400">
                    <div>{{ t('total') }}: {{ archiveTotal }}</div>
                    <div class="flex gap-2">
                        <button @click="archivePrev" :disabled="archiveOffset === 0" class="px-3 py-1 rounded border border-nexus-700 hover:border-nexus-500 disabled:opacity-40 disabled:hover:border-nexus-700">{{ t('prev') }}</button>
                        <button @click="archiveNext" :disabled="archiveOffset + archiveLimit >= archiveTotal" class="px-3 py-1 rounded border border-nexus-700 hover:border-nexus-500 disabled:opacity-40 disabled:hover:border-nexus-700">{{ t('next') }}</button>
                    </div>
                </div>
            </div>

            <!-- Admin View -->
            <div v-if="currentTab === 'admin'" class="p-4 md:p-8 space-y-8">
                <header class="flex justify-between items-center">
                    <h2 class="text-3xl font-bold text-white">Admin Panel</h2>
                </header>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- System Controls -->
                    <div class="glass p-6 rounded-xl border border-nexus-700 space-y-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="settings" class="w-5 h-5 text-nexus-400"></i> System Controls</h3>
                        
                        <!-- Backup -->
                        <div class="p-4 bg-nexus-900/50 rounded-lg border border-nexus-700">
                            <h4 class="text-sm font-bold text-gray-300 mb-2">System Backup</h4>
                            <button @click="triggerBackup" :disabled="loading" class="w-full bg-nexus-700 hover:bg-nexus-600 text-white py-2 rounded transition-colors flex justify-center items-center gap-2">
                                <i data-lucide="database-backup" class="w-4 h-4"></i> Backup Now
                            </button>
                            <button @click="downloadBackup" :disabled="loading" class="mt-2 w-full bg-nexus-800 hover:bg-nexus-700 text-white py-2 rounded transition-colors flex justify-center items-center gap-2">
                                <i data-lucide="download" class="w-4 h-4"></i> {{ t('download_backup') }}
                            </button>
                        </div>

                        <!-- Health -->
                        <div class="p-4 bg-nexus-900/50 rounded-lg border border-nexus-700 space-y-2">
                            <h4 class="text-sm font-bold text-gray-300 mb-2">{{ t('health_status') }}</h4>
                            <div class="grid grid-cols-3 gap-2 text-center">
                                <div class="p-3 rounded border border-nexus-700">
                                    <div class="text-2xl text-white">{{ health.data?.users ?? 0 }}</div>
                                    <div class="text-xs text-gray-400">{{ t('total_users') }}</div>
                                </div>
                                <div class="p-3 rounded border border-nexus-700">
                                    <div class="text-2xl text-white">{{ health.data?.games ?? 0 }}</div>
                                    <div class="text-xs text-gray-400">{{ t('active_games') }}</div>
                                </div>
                                <div class="p-3 rounded border border-nexus-700">
                                    <div class="text-2xl text-white">{{ health.data?.events_24h ?? 0 }}</div>
                                    <div class="text-xs text-gray-400">{{ t('events_24h') }}</div>
                                </div>
                            </div>
                        </div>

                        <!-- Maintenance -->
                        <div class="p-4 bg-nexus-900/50 rounded-lg border border-nexus-700 space-y-2">
                            <h4 class="text-sm font-bold text-gray-300 mb-2">{{ t('maintenance_mode') }}</h4>
                            <label class="flex items-center justify-between cursor-pointer">
                                <span class="text-sm text-gray-400">{{ maintenance.enabled ? t('active') : t('disabled') }}</span>
                                <div class="relative">
                                    <input type="checkbox" :checked="maintenance.enabled" @change="toggleMaintenance($event.target.checked)" class="sr-only peer">
                                    <div class="w-11 h-6 bg-gray-700 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
                                </div>
                            </label>
                        </div>

                        <!-- Quick Actions -->
                        <div class="p-4 bg-nexus-900/50 rounded-lg border border-nexus-700 space-y-2">
                             <h4 class="text-sm font-bold text-gray-300 mb-2">Management</h4>
                             <button @click="showAddGameModal = true" class="w-full bg-nexus-500 hover:bg-blue-600 text-white py-2 rounded transition-colors flex justify-center items-center gap-2">
                                <i data-lucide="plus-circle" class="w-4 h-4"></i> Add New Game
                             </button>
                             <button @click="currentTab = 'users'" class="w-full bg-nexus-700 hover:bg-nexus-600 text-white py-2 rounded transition-colors flex justify-center items-center gap-2">
                                <i data-lucide="users" class="w-4 h-4"></i> Manage Users
                             </button>
                        </div>
                    </div>

                    <!-- Audit Log -->
                    <div class="glass p-6 rounded-xl border border-nexus-700 space-y-4 md:col-span-2">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="file-text" class="w-5 h-5 text-nexus-400"></i> {{ t('audit_log') }}</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full text-sm">
                                <thead>
                                    <tr class="text-gray-400">
                                        <th class="text-left p-2">ID</th>
                                        <th class="text-left p-2">{{ t('time') }}</th>
                                        <th class="text-left p-2">Action</th>
                                        <th class="text-left p-2">Details</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="row in audit.items" :key="row.id" class="border-t border-nexus-800">
                                        <td class="p-2 text-gray-300">{{ row.id }}</td>
                                        <td class="p-2 text-gray-300">{{ row.timestamp }}</td>
                                        <td class="p-2 text-white">{{ row.action }}</td>
                                        <td class="p-2 text-gray-300">
                                            <pre class="whitespace-pre-wrap break-words">{{ JSON.stringify(row.details || {}, null, 2) }}</pre>
                                        </td>
                                    </tr>
                                    <tr v-if="audit.items.length === 0">
                                        <td colspan="4" class="p-4 text-center text-gray-400">{{ t('no_results') }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="flex justify-end">
                            <button @click="fetchAudit" class="px-3 py-2 rounded border border-nexus-700 hover:border-nexus-500 text-gray-300">{{ t('refresh') }}</button>
                        </div>
                    </div>

                    <!-- Platform Settings -->
                    <div class="glass p-6 rounded-xl border border-nexus-700 space-y-4 md:col-span-2 lg:col-span-3">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="sliders" class="w-5 h-5 text-nexus-400"></i> Platform Configuration</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <!-- Adjust -->
                            <div class="bg-nexus-900/50 p-4 rounded-lg border border-nexus-700 space-y-3">
                                <h4 class="text-sm font-bold text-gray-300 border-b border-nexus-700 pb-2">Adjust</h4>
                                <label class="flex items-center justify-between cursor-pointer">
                                    <span class="text-sm text-gray-400">Server API</span>
                                    <div class="relative">
                                        <input type="checkbox" v-model="platformSettings.adjust_server" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
                                    </div>
                                </label>
                                <label class="flex items-center justify-between cursor-pointer">
                                    <span class="text-sm text-gray-400">Client SDK</span>
                                    <div class="relative">
                                        <input type="checkbox" v-model="platformSettings.adjust_client" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
                                    </div>
                                </label>
                            </div>
                            
                            <!-- AppsFlyer -->
                            <div class="bg-nexus-900/50 p-4 rounded-lg border border-nexus-700 space-y-3">
                                <h4 class="text-sm font-bold text-gray-300 border-b border-nexus-700 pb-2">AppsFlyer</h4>
                                <label class="flex items-center justify-between cursor-pointer">
                                    <span class="text-sm text-gray-400">Server API</span>
                                    <div class="relative">
                                        <input type="checkbox" v-model="platformSettings.appsflyer_server" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
                                    </div>
                                </label>
                                <label class="flex items-center justify-between cursor-pointer">
                                    <span class="text-sm text-gray-400">Client SDK</span>
                                    <div class="relative">
                                        <input type="checkbox" v-model="platformSettings.appsflyer_client" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
                                    </div>
                                </label>
                            </div>

                            <!-- Singular -->
                            <div class="bg-nexus-900/50 p-4 rounded-lg border border-nexus-700 space-y-3">
                                <h4 class="text-sm font-bold text-gray-300 border-b border-nexus-700 pb-2">Singular</h4>
                                <label class="flex items-center justify-between cursor-pointer">
                                    <span class="text-sm text-gray-400">Server API</span>
                                    <div class="relative">
                                        <input type="checkbox" v-model="platformSettings.singular_server" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
                                    </div>
                                </label>
                                <label class="flex items-center justify-between cursor-pointer">
                                    <span class="text-sm text-gray-400">Client SDK</span>
                                    <div class="relative">
                                        <input type="checkbox" v-model="platformSettings.singular_client" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
                                    </div>
                                </label>
                            </div>
                        </div>
                        <div class="flex justify-end pt-4">
                            <button @click="savePlatformSettings" class="bg-nexus-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg flex items-center gap-2">
                                <i data-lucide="save" class="w-4 h-4"></i> Save Settings
                            </button>
                        </div>
                    </div>

                    <div v-if="currentUser?.role === 'admin'" class="glass p-6 rounded-xl border border-nexus-700 space-y-4 md:col-span-2 lg:col-span-3">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-bold text-white flex items-center gap-2">
                                <i data-lucide="network" class="w-5 h-5 text-nexus-400"></i> ÿßŸÑÿ¥ÿ®ŸÉÿ© ŸàÿßŸÑÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™
                            </h3>
                            <button @click="fetchNetworkStatus" class="text-xs bg-nexus-800 hover:bg-nexus-700 p-1 rounded">
                                <i data-lucide="refresh-cw" class="w-3 h-3"></i>
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="bg-nexus-900/50 p-4 rounded-lg border border-nexus-700 space-y-3">
                                <div class="flex items-center justify-between">
                                    <div class="text-sm text-gray-400">IP ÿßŸÑÿ≠ÿßŸÑŸä ÿ®ÿØŸàŸÜ ÿ®ÿ±ŸàŸÉÿ≥Ÿä</div>
                                    <div class="text-sm font-mono text-white">{{ networkStatus.direct_ip || '‚Äî' }}</div>
                                </div>
                                <div class="text-xs text-gray-500">
                                    ŸÅŸä ÿ≠ÿßŸÑ ŸÉÿßŸÜ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÑÿØŸäŸá ÿ®ÿ±ŸàŸÉÿ≥Ÿä ÿÆÿßÿµ Ÿäÿ™ŸÖ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ŸÖŸÜŸá. ÿÆŸÑÿßŸÅ ÿ∞ŸÑŸÉ Ÿäÿ™ŸÖ ÿßŸÑÿ™ŸÜÿßŸàÿ® ÿ®ŸäŸÜ ÿßŸÑÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™ ÿßŸÑÿπÿßŸÖÿ© ÿπŸÜÿØ ÿ™ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ.
                                </div>
                                <div class="flex gap-2">
                                    <button @click="saveGlobalProxies" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-bold">
                                        <i data-lucide="save" class="w-4 h-4 inline"></i> ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™
                                    </button>
                                    <button @click="fetchNetworkStatus" class="bg-nexus-700 hover:bg-nexus-600 text-white px-4 py-2 rounded-lg text-sm font-bold">
                                        <i data-lucide="activity" class="w-4 h-4 inline"></i> ÿßÿÆÿ™ÿ®ÿßÿ± IP
                                    </button>
                                    <button @click="importProxies('geonode')" class="bg-nexus-800 hover:bg-nexus-700 text-white px-4 py-2 rounded-lg text-sm font-bold">
                                        ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ GeoNode (US)
                                    </button>
                                    <button @click="importProxies('proxyscrape')" class="bg-nexus-800 hover:bg-nexus-700 text-white px-4 py-2 rounded-lg text-sm font-bold">
                                        ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ProxyScrape (US)
                                    </button>
                                </div>
                            </div>

                            <div class="bg-nexus-900/50 p-4 rounded-lg border border-nexus-700 space-y-2">
                                <div class="text-sm font-bold text-gray-300">ÿßŸÑÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™ ÿßŸÑÿπÿßŸÖÿ© (ÿ≥ÿ∑ÿ± ŸÑŸÉŸÑ ÿ®ÿ±ŸàŸÉÿ≥Ÿä)</div>
                                <textarea v-model="globalProxiesText" rows="6" placeholder="http://USER:PASS@IP:PORT&#10;socks5://USER:PASS@IP:PORT" class="w-full bg-nexus-900/50 border border-nexus-700 rounded-lg p-3 text-white text-sm focus:border-nexus-500 outline-none resize-none font-mono"></textarea>
                                <div class="text-xs text-gray-500">
                                    ÿ®ÿ±ŸàŸÉÿ≥Ÿä Ÿàÿßÿ≠ÿØ: Ÿäÿ≥ÿ™ÿÆÿØŸÖ ÿØÿßÿ¶ŸÖÿßŸã. ÿ£ŸÉÿ´ÿ± ŸÖŸÜ ÿ®ÿ±ŸàŸÉÿ≥Ÿä: Ÿäÿ™ŸÖ ÿßŸÑÿ™ŸÜÿßŸàÿ® ÿ®ŸäŸÜŸáŸÖ ÿπŸÜÿØ ÿ™ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ.<br>
                                    ŸÑŸÑÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™ SOCKS5 Ÿäÿ¨ÿ® ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ®ÿßÿØÿ¶ÿ© <code>socks5://</code>
                                </div>
                            </div>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="text-gray-400 border-b border-nexus-700">
                                    <tr>
                                        <th class="pb-2">Proxy</th>
                                        <th class="pb-2">IP</th>
                                        <th class="pb-2">Status</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300 divide-y divide-nexus-800">
                                    <tr v-for="p in networkStatus.proxies" :key="p.masked">
                                        <td class="py-2 font-mono text-xs text-gray-300">{{ p.masked }}</td>
                                        <td class="py-2 font-mono text-xs text-white">{{ p.ip || '‚Äî' }}</td>
                                        <td class="py-2">
                                            <span v-if="p.ok" class="text-green-400 text-xs font-bold">OK</span>
                                            <span v-else class="text-red-400 text-xs font-bold" :title="p.error">FAIL</span>
                                        </td>
                                    </tr>
                                    <tr v-if="!networkStatus.proxies || networkStatus.proxies.length === 0">
                                        <td class="py-3 text-gray-500 text-sm" colspan="3">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™ ÿπÿßŸÖÿ©.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Change Logs -->
                    <div class="glass p-6 rounded-xl border border-nexus-700 space-y-4 md:col-span-2 lg:col-span-3">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="history" class="w-5 h-5 text-nexus-400"></i> Change Logs</h3>
                            <button @click="fetchChangelogs" class="text-xs bg-nexus-800 hover:bg-nexus-700 p-1 rounded"><i data-lucide="refresh-cw" class="w-3 h-3"></i></button>
                        </div>
                        <div class="overflow-x-auto max-h-60 overflow-y-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="text-gray-400 border-b border-nexus-700">
                                    <tr>
                                        <th class="pb-2">Time</th>
                                        <th class="pb-2">Editor</th>
                                        <th class="pb-2">Action</th>
                                        <th class="pb-2">Details</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300 divide-y divide-nexus-800">
                                    <tr v-for="log in changelogs" :key="log.id">
                                        <td class="py-2 font-mono text-xs">{{ log.time }}</td>
                                        <td class="py-2 text-blue-400">{{ log.editor }}</td>
                                        <td class="py-2">{{ log.action }}</td>
                                        <td class="py-2 font-mono text-xs text-gray-500 truncate max-w-xs">{{ JSON.stringify(log.details) }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>


                    <!-- Broadcast -->
                    <div class="glass p-6 rounded-xl border border-nexus-700 space-y-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="megaphone" class="w-5 h-5 text-nexus-400"></i> Broadcast</h3>
                        <textarea v-model="broadcastMsg" rows="4" placeholder="Type message to all users..." class="w-full bg-nexus-900/50 border border-nexus-700 rounded-lg p-3 text-white text-sm focus:border-nexus-500 outline-none resize-none"></textarea>
                        <button @click="sendBroadcast" :disabled="!broadcastMsg" class="w-full bg-nexus-500 hover:bg-blue-600 text-white py-2 rounded-lg transition-colors flex justify-center items-center gap-2">
                            <i data-lucide="send" class="w-4 h-4"></i> Send Broadcast
                        </button>
                    </div>

                    <!-- System Overview -->
                    <div class="glass p-6 rounded-xl border border-nexus-700 space-y-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="bar-chart-2" class="w-5 h-5 text-nexus-400"></i> System Overview</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center p-3 bg-nexus-900/50 rounded-lg">
                                <span class="text-gray-400 text-sm">Total Users</span>
                                <span class="text-white font-bold font-mono">{{ stats.users }}</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-nexus-900/50 rounded-lg">
                                <span class="text-gray-400 text-sm">Active Games</span>
                                <span class="text-white font-bold font-mono">{{ stats.games?.active }}</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-nexus-900/50 rounded-lg">
                                <span class="text-gray-400 text-sm">Events (24h)</span>
                                <span class="text-nexus-accent font-bold font-mono">{{ stats.events?.last_24h }}</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-nexus-900/50 rounded-lg">
                                <span class="text-gray-400 text-sm">Total Events</span>
                                <span class="text-white font-bold font-mono">{{ stats.events?.total }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Timelines Manager -->
                <div class="glass rounded-xl p-6 border border-nexus-700">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="calendar-clock" class="w-5 h-5 text-nexus-400"></i> Timelines</h3>
                        <div class="flex gap-2 items-center">
                            <select v-model="selectedTimelineGame" @change="fetchGameTimelines" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm outline-none focus:border-nexus-500">
                                <option :value="null">Select Game...</option>
                                <option v-for="g in games" :key="g.id" :value="g.id">{{ g.name }}</option>
                            </select>
                            <button @click="saveTimelines" :disabled="!selectedTimelineGame" class="bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed">
                                Save Changes
                            </button>
                        </div>
                    </div>

                    <div v-if="selectedTimelineGame" class="space-y-4">
                        <!-- Add New Step -->
                        <div class="bg-nexus-800/50 p-4 rounded-lg border border-nexus-700 flex flex-wrap gap-3 items-end">
                            <div class="flex-1 min-w-[150px]">
                                <label class="text-xs text-gray-500 mb-1 block">Step Name</label>
                                <input v-model="timelineForm.step_name" placeholder="e.g. Level 10" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                            </div>
                            <div class="flex-1 min-w-[150px]">
                                <label class="text-xs text-gray-500 mb-1 block">Event Value/Token</label>
                                <input v-model="timelineForm.event_value" placeholder="Value" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                            </div>
                            <div class="w-24">
                                <label class="text-xs text-gray-500 mb-1 block">Days</label>
                                <input v-model="timelineForm.day_offset" type="number" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                            </div>
                            <div class="w-24">
                                <label class="text-xs text-gray-500 mb-1 block">Hours</label>
                                <input v-model="timelineForm.hour_offset" type="number" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                            </div>
                            <button @click="addTimelineStep" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm h-[38px]">Add</button>
                        </div>

                        <!-- Steps List -->
                        <div class="bg-nexus-900 rounded-lg border border-nexus-700 overflow-hidden">
                            <table class="w-full text-left text-sm">
                                <thead class="bg-nexus-800 text-gray-400">
                                    <tr>
                                        <th class="p-3">Step Name</th>
                                        <th class="p-3">Event Value</th>
                                        <th class="p-3">Offset</th>
                                        <th class="p-3 text-right">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-nexus-700">
                                    <tr v-for="(step, index) in timelineSteps" :key="index" class="hover:bg-nexus-800/50">
                                        <td class="p-3 font-medium text-white">{{ step.step_name }}</td>
                                        <td class="p-3 font-mono text-gray-400">{{ step.event_value }}</td>
                                        <td class="p-3 text-blue-400">{{ step.day_offset }}d {{ step.hour_offset }}h</td>
                                        <td class="p-3 text-right">
                                            <button @click="removeTimelineStep(index)" class="text-red-400 hover:text-red-300"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </td>
                                    </tr>
                                    <tr v-if="timelineSteps.length === 0">
                                        <td colspan="4" class="p-4 text-center text-gray-500">No timeline steps configured.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div v-else class="text-center py-12 text-gray-500 border border-dashed border-nexus-700 rounded-lg">
                        Select a game to manage its timeline.
                    </div>
                </div>
            </div>

            <!-- Logs View -->
            <div v-if="currentTab === 'logs'" class="flex flex-col h-full p-4">
                <div class="flex-1 bg-black rounded-xl border border-nexus-700 p-4 font-mono text-sm overflow-y-auto" id="log-container">
                    <div v-for="(msg, index) in liveLogs" :key="index" class="mb-1 border-l-2 border-nexus-500 pl-2">
                        <span class="text-gray-500">[{{ new Date().toLocaleTimeString() }}]</span>
                        <span class="text-gray-300 ml-2" v-html="formatLog(msg)"></span>
                    </div>
                </div>
            </div>

            <div v-if="currentTab === 'chat'" class="flex flex-col h-full p-6 gap-4">
                <div class="flex items-center justify-between">
                    <div class="flex flex-col">
                        <h2 class="text-2xl font-bold text-white">{{ t('chat') }}</h2>
                        <p class="text-gray-400 text-sm">{{ t('chat_desc') }}</p>
                    </div>
                    <button @click="fetchChatConversations" class="p-2 bg-nexus-700 rounded-lg hover:bg-nexus-600" :title="t('refresh')">
                        <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                    </button>
                </div>

                <div class="flex-1 grid grid-cols-1 lg:grid-cols-3 gap-4 min-h-0">
                    <div class="glass rounded-xl border border-nexus-700 overflow-hidden flex flex-col min-h-0">
                        <div class="p-3 border-b border-nexus-700 flex items-center justify-between">
                            <span class="text-xs text-gray-400 font-bold uppercase">{{ t('conversations') }}</span>
                            <span class="text-[10px] text-gray-500">{{ chatConversations.length }}</span>
                        </div>
                        <div class="flex-1 overflow-y-auto">
                            <button v-for="c in chatConversations" :key="c.id" @click="openChatConversation(c)" class="w-full text-left px-4 py-3 border-b border-nexus-800 hover:bg-nexus-800/60 transition-colors">
                                <div class="flex items-center justify-between">
                                    <div class="flex flex-col">
                                        <span class="text-sm font-bold text-white">#{{ c.id }} ‚Ä¢ {{ c.kind }}</span>
                                        <span class="text-[11px] text-gray-400 font-mono">A: {{ c.user_a_id }}<span v-if="c.user_b_id"> ‚Ä¢ B: {{ c.user_b_id }}</span></span>
                                    </div>
                                    <span class="text-[10px] text-gray-500">{{ c.updated_at ? new Date(c.updated_at).toLocaleString() : '' }}</span>
                                </div>
                                <div v-if="c.last_message" class="text-[11px] text-gray-400 mt-1 truncate">
                                    <span class="text-gray-500">{{ c.last_message.sender_role }}:</span> {{ c.last_message.body }}
                                </div>
                            </button>
                            <div v-if="chatConversations.length === 0" class="p-6 text-center text-gray-500 text-sm">
                                {{ t('no_conversations') }}
                            </div>
                        </div>
                    </div>

                    <div class="glass rounded-xl border border-nexus-700 overflow-hidden flex flex-col lg:col-span-2 min-h-0">
                        <div class="p-3 border-b border-nexus-700 flex items-center justify-between">
                            <span class="text-xs text-gray-400 font-bold uppercase">
                                {{ chatSelectedConversation ? ('#' + chatSelectedConversation.id) : t('select_conversation') }}
                            </span>
                            <button v-if="chatSelectedConversation" @click="fetchChatMessages(chatSelectedConversation.id)" class="text-xs bg-nexus-700 hover:bg-nexus-600 px-3 py-1 rounded text-white">
                                {{ t('refresh') }}
                            </button>
                        </div>

                        <div class="flex-1 overflow-y-auto p-4 space-y-2 min-h-0">
                            <div v-for="m in chatMessages" :key="m.id" class="flex" :class="m.sender_role === 'admin' ? 'justify-end' : 'justify-start'">
                                <div class="max-w-[80%] rounded-lg px-3 py-2 border border-white/10" :class="m.sender_role === 'admin' ? 'bg-nexus-600/40 text-white' : 'bg-nexus-900/40 text-gray-200'">
                                    <div class="text-[10px] text-gray-400 flex items-center justify-between gap-3">
                                        <span class="font-mono">{{ m.sender_role }}<span v-if="m.sender_user_id">:{{ m.sender_user_id }}</span></span>
                                        <span>{{ m.created_at ? new Date(m.created_at).toLocaleString() : '' }}</span>
                                    </div>
                                    <div class="text-sm whitespace-pre-wrap mt-1">{{ m.body }}</div>
                                </div>
                            </div>
                            <div v-if="chatSelectedConversation && chatMessages.length === 0" class="text-center text-gray-500 text-sm">
                                {{ t('no_messages') }}
                            </div>
                            <div v-if="!chatSelectedConversation" class="text-center text-gray-500 text-sm">
                                {{ t('select_conversation_hint') }}
                            </div>
                            <div id="chat-scroll-anchor"></div>
                        </div>

                        <div class="p-3 border-t border-nexus-700 flex items-center gap-2">
                            <input v-model="chatNewMessage" :disabled="!chatSelectedConversation" :placeholder="t('type_message')" class="flex-1 bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <button @click="sendChatMessage" :disabled="!chatSelectedConversation || !chatNewMessage.trim()" class="bg-nexus-500 hover:bg-blue-600 disabled:opacity-50 disabled:hover:bg-nexus-500 text-white px-4 py-2 rounded text-sm font-bold">
                                {{ t('send') }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- My Office -->
            <div v-if="currentTab === 'office'" class="p-4 md:p-8 space-y-6">
                <header class="flex justify-between items-center">
                    <h2 class="text-3xl font-bold text-white">{{ t('office') }}</h2>
                </header>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="glass p-6 rounded-xl border border-nexus-700 space-y-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="bell" class="w-5 h-5 text-nexus-400"></i> {{ t('notifications') }}</h3>
                        <p class="text-gray-400 text-sm">{{ t('no_notifications') }}</p>
                    </div>
                    <div class="glass p-6 rounded-xl border border-nexus-700 space-y-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="sparkles" class="w-5 h-5 text-nexus-400"></i> {{ t('recommendations') }}</h3>
                        <p class="text-gray-400 text-sm">{{ t('no_recommendations') }}</p>
                    </div>
                </div>
            </div>

            <!-- Details Modal -->
            <div v-if="detailsModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
                <div class="glass w-full max-w-6xl h-[90vh] rounded-xl border border-nexus-700 flex flex-col overflow-hidden shadow-2xl shadow-nexus-900">
                    
                    <!-- Modal Header -->
                    <div class="p-4 border-b border-nexus-700 flex justify-between items-center bg-nexus-800/50">
                        <div class="flex items-center gap-4">
                            <div class="bg-nexus-700 p-2 rounded-lg">
                                <i data-lucide="activity" class="w-6 h-6 text-nexus-400"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-white flex items-center gap-2">
                                    {{ selectedLog.event }}
                                    <span :class="selectedLog.status < 400 ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'" class="text-xs px-2 py-0.5 rounded-full border border-white/10">
                                        {{ selectedLog.status }}
                                    </span>
                                </h3>
                                <p class="text-sm text-gray-400 font-mono">{{ selectedLog.timestamp }} | {{ selectedLog.game }}</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                            <button @click="openEditResend" class="p-2 hover:bg-nexus-700 rounded-lg text-gray-400 hover:text-white" title="Edit & Resend">
                                <i data-lucide="edit-3" class="w-5 h-5"></i>
                            </button>
                            <button @click="saveLogDetails" class="p-2 hover:bg-nexus-700 rounded-lg text-gray-400 hover:text-white" title="Save as JSON">
                                <i data-lucide="download" class="w-5 h-5"></i>
                            </button>
                            <button @click="detailsModal = false" class="p-2 hover:bg-red-500/20 rounded-lg text-gray-400 hover:text-red-400">
                                <i data-lucide="x" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Modal Body -->
                    <div class="flex-1 flex overflow-hidden">
                        <!-- Sidebar Navigation -->
                        <div class="w-48 bg-nexus-900/50 border-r border-nexus-700 flex flex-col p-2 gap-1">
                            <button @click="detailTab = 'summary'" :class="detailTab === 'summary' ? 'bg-nexus-700 text-white' : 'text-gray-400 hover:text-white'" class="flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm font-medium">
                                <i data-lucide="bar-chart-2" class="w-4 h-4"></i> Summary
                            </button>
                            <button @click="detailTab = 'request'" :class="detailTab === 'request' ? 'bg-nexus-700 text-white' : 'text-gray-400 hover:text-white'" class="flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm font-medium">
                                <i data-lucide="arrow-up-right" class="w-4 h-4"></i> Request
                            </button>
                            <button @click="detailTab = 'response'" :class="detailTab === 'response' ? 'bg-nexus-700 text-white' : 'text-gray-400 hover:text-white'" class="flex items-center gap-2 px-3 py-2 rounded-lg transition-colors text-sm font-medium">
                                <i data-lucide="arrow-down-left" class="w-4 h-4"></i> Response
                            </button>
                        </div>

                        <!-- Content Area -->
                        <div class="flex-1 overflow-y-auto p-6 bg-nexus-900/30">
                            
                            <!-- Summary Tab -->
                            <div v-if="detailTab === 'summary'" class="space-y-6 animate-fadeIn">
                                <div class="grid grid-cols-3 gap-4">
                                    <div class="bg-nexus-800 p-4 rounded-lg border border-nexus-700">
                                        <p class="text-gray-500 text-xs uppercase font-bold">Latency</p>
                                        <p class="text-2xl font-mono text-white mt-1">{{ selectedLog.response.time_ms.toFixed(2) }} ms</p>
                                    </div>
                                    <div class="bg-nexus-800 p-4 rounded-lg border border-nexus-700">
                                        <p class="text-gray-500 text-xs uppercase font-bold">Status</p>
                                        <p :class="selectedLog.status < 400 ? 'text-green-400' : 'text-red-400'" class="text-2xl font-mono mt-1">{{ selectedLog.status }}</p>
                                    </div>
                                    <div class="bg-nexus-800 p-4 rounded-lg border border-nexus-700">
                                        <p class="text-gray-500 text-xs uppercase font-bold">Platform</p>
                                        <p class="text-2xl font-mono text-white mt-1">{{ selectedLog.platform }}</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Request Tab -->
                            <div v-if="detailTab === 'request'" class="space-y-6 animate-fadeIn">
                                <!-- Headers -->
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <h4 class="text-white font-bold flex items-center gap-2"><i data-lucide="list" class="w-4 h-4 text-nexus-400"></i> Headers</h4>
                                        <div class="flex gap-2">
                                            <input v-model="headerSearch" placeholder="Filter headers..." class="bg-nexus-900 border border-nexus-700 text-xs px-2 py-1 rounded text-gray-300 focus:outline-none focus:border-nexus-500">
                                            <button @click="copyToClipboard(JSON.stringify(selectedLog.request.headers, null, 2))" class="text-xs bg-nexus-700 hover:bg-nexus-600 px-2 py-1 rounded text-white transition-colors">Copy</button>
                                        </div>
                                    </div>
                                    <div class="bg-nexus-900 rounded-lg border border-nexus-700 overflow-hidden">
                                        <table class="w-full text-sm">
                                            <tr v-for="(val, key) in selectedLog.request.headers" :key="key" v-show="!headerSearch || key.toLowerCase().includes(headerSearch.toLowerCase()) || String(val).toLowerCase().includes(headerSearch.toLowerCase())" class="border-b border-nexus-800 last:border-0">
                                                <td class="px-4 py-2 font-mono w-1/3 border-r border-nexus-800" :class="['Authorization', 'Content-Type', 'User-Agent'].includes(key) ? 'text-yellow-400 font-bold' : 'text-nexus-400'">{{ key }}</td>
                                                <td class="px-4 py-2 text-gray-300 font-mono break-all">{{ val }}</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>

                                <!-- Body -->
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <h4 class="text-white font-bold flex items-center gap-2"><i data-lucide="code" class="w-4 h-4 text-nexus-400"></i> Body</h4>
                                        <div class="flex gap-2">
                                            <button @click="rawView = !rawView" class="text-xs bg-nexus-800 hover:bg-nexus-700 border border-nexus-600 px-2 py-1 rounded text-gray-300 transition-colors">{{ rawView ? 'Pretty' : 'Raw' }}</button>
                                            <span class="text-xs text-gray-500 py-1">{{ selectedLog.request.body ? selectedLog.request.body.length : 0 }} bytes</span>
                                            <button @click="copyToClipboard(selectedLog.request.body)" class="text-xs bg-nexus-700 hover:bg-nexus-600 px-2 py-1 rounded text-white transition-colors">Copy</button>
                                        </div>
                                    </div>
                                    <pre class="bg-nexus-900 p-4 rounded-lg border border-nexus-700 overflow-x-auto text-sm font-mono text-gray-300 max-h-96"><code :class="rawView ? 'language-none' : 'language-json'">{{ rawView ? selectedLog.request.body : formatBody(selectedLog.request.body) }}</code></pre>
                                </div>
                            </div>

                            <!-- Response Tab -->
                            <div v-if="detailTab === 'response'" class="space-y-6 animate-fadeIn">
                                <!-- Headers -->
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <h4 class="text-white font-bold flex items-center gap-2"><i data-lucide="list" class="w-4 h-4 text-nexus-400"></i> Headers</h4>
                                        <div class="flex gap-2">
                                            <input v-model="headerSearch" placeholder="Filter headers..." class="bg-nexus-900 border border-nexus-700 text-xs px-2 py-1 rounded text-gray-300 focus:outline-none focus:border-nexus-500">
                                            <button @click="copyToClipboard(JSON.stringify(selectedLog.response.headers, null, 2))" class="text-xs bg-nexus-700 hover:bg-nexus-600 px-2 py-1 rounded text-white transition-colors">Copy</button>
                                        </div>
                                    </div>
                                    <div class="bg-nexus-900 rounded-lg border border-nexus-700 overflow-hidden">
                                        <table class="w-full text-sm">
                                            <tr v-for="(val, key) in selectedLog.response.headers" :key="key" v-show="!headerSearch || key.toLowerCase().includes(headerSearch.toLowerCase()) || String(val).toLowerCase().includes(headerSearch.toLowerCase())" class="border-b border-nexus-800 last:border-0">
                                                <td class="px-4 py-2 font-mono w-1/3 border-r border-nexus-800" :class="['Authorization', 'Content-Type', 'Date'].includes(key) ? 'text-yellow-400 font-bold' : 'text-nexus-400'">{{ key }}</td>
                                                <td class="px-4 py-2 text-gray-300 font-mono break-all">{{ val }}</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>

                                <!-- Body -->
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <h4 class="text-white font-bold flex items-center gap-2"><i data-lucide="code" class="w-4 h-4 text-nexus-400"></i> Body</h4>
                                        <div class="flex gap-2">
                                            <button @click="rawView = !rawView" class="text-xs bg-nexus-800 hover:bg-nexus-700 border border-nexus-600 px-2 py-1 rounded text-gray-300 transition-colors">{{ rawView ? 'Pretty' : 'Raw' }}</button>
                                            <span class="text-xs text-gray-500 py-1">{{ selectedLog.response.body ? selectedLog.response.body.length : 0 }} bytes</span>
                                            <button @click="copyToClipboard(selectedLog.response.body)" class="text-xs bg-nexus-700 hover:bg-nexus-600 px-2 py-1 rounded text-white transition-colors">Copy</button>
                                        </div>
                                    </div>
                                    <pre class="bg-nexus-900 p-4 rounded-lg border border-nexus-700 overflow-x-auto text-sm font-mono text-gray-300 max-h-96"><code :class="rawView ? 'language-none' : 'language-json'">{{ rawView ? selectedLog.response.body : formatBody(selectedLog.response.body) }}</code></pre>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <!-- Edit & Resend Modal -->
            <div v-if="showEditResendModal" class="fixed inset-0 z-[60] flex items-center justify-center bg-black/90 backdrop-blur-md p-4">
                <div class="glass w-full max-w-2xl rounded-xl border border-nexus-700 p-6 space-y-4 shadow-2xl shadow-blue-900/20">
                    <h3 class="text-xl font-bold text-white flex items-center gap-2">
                        <i data-lucide="send" class="w-5 h-5 text-nexus-400"></i> Edit & Resend Request
                    </h3>
                    <p class="text-sm text-gray-400">Modify the request body before resending. A new event will be generated.</p>
                    
                    <div class="space-y-2">
                        <label class="text-xs text-gray-500 font-bold uppercase">Request Body (JSON)</label>
                        <textarea v-model="resendBody" rows="10" class="w-full bg-nexus-900 border border-nexus-700 rounded-lg p-3 text-white font-mono text-sm focus:border-nexus-500 outline-none resize-none"></textarea>
                    </div>

                    <div class="flex gap-3 justify-end mt-4">
                        <button @click="showEditResendModal = false" class="text-gray-400 hover:text-white text-sm">{{ t('cancel') }}</button>
                        <button @click="submitResend" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold shadow-lg shadow-blue-500/20 flex items-center gap-2">
                            <i data-lucide="send" class="w-4 h-4"></i> Resend Request
                        </button>
                    </div>
                </div>
            </div>

            <!-- Finance Management View -->
            <div v-if="currentTab === 'finance'" class="p-4 md:p-8 space-y-8">
                <header class="flex justify-between items-center mb-8">
                    <div>
                        <h2 class="text-3xl font-bold text-white">{{ t('finance_management') }}</h2>
                        <p class="text-gray-400 mt-1">Manage finances, transactions, and coupons</p>
                    </div>
                </header>

                <!-- Finance Sub-Tabs -->
                <div class="flex gap-4 border-b border-nexus-700 pb-4">
                    <button @click="financeTab = 'stats'" :class="financeTab === 'stats' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">
                        <i data-lucide="pie-chart" class="w-4 h-4 inline mr-2"></i> {{ t('stats') }}
                    </button>
                    <button @click="financeTab = 'transactions'" :class="financeTab === 'transactions' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">
                        <i data-lucide="list" class="w-4 h-4 inline mr-2"></i> {{ t('transactions') }}
                    </button>
                    <button @click="financeTab = 'coupons'" :class="financeTab === 'coupons' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">
                        <i data-lucide="ticket" class="w-4 h-4 inline mr-2"></i> {{ t('coupons') }}
                    </button>
                    <button @click="financeTab = 'reset'" :class="financeTab === 'reset' ? 'bg-red-600 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">
                        <i data-lucide="alert-triangle" class="w-4 h-4 inline mr-2"></i> {{ t('wallet_reset') }}
                    </button>
                    <button @click="financeTab = 'settings'" :class="financeTab === 'settings' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">
                        <i data-lucide="settings" class="w-4 h-4 inline mr-2"></i> {{ t('settings') }}
                    </button>
                </div>

                <!-- Stats Tab -->
                <div v-if="financeTab === 'stats'" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="glass p-6 rounded-xl border border-nexus-700 relative overflow-hidden">
                        <h3 class="text-gray-400 text-sm font-medium">Total User Balance</h3>
                        <p class="text-3xl font-bold text-white mt-2">${{ financeStats.total_user_balance?.toFixed(2) }}</p>
                    </div>
                    <div class="glass p-6 rounded-xl border border-nexus-700 relative overflow-hidden">
                        <h3 class="text-gray-400 text-sm font-medium">Total Deposits</h3>
                        <p class="text-3xl font-bold text-green-400 mt-2">+${{ financeStats.total_deposits?.toFixed(2) }}</p>
                    </div>
                    <div class="glass p-6 rounded-xl border border-nexus-700 relative overflow-hidden">
                        <h3 class="text-gray-400 text-sm font-medium">Total Withdrawals</h3>
                        <p class="text-3xl font-bold text-red-400 mt-2">-${{ financeStats.total_withdrawals?.toFixed(2) }}</p>
                    </div>
                    <div class="glass p-6 rounded-xl border border-nexus-700 relative overflow-hidden">
                        <h3 class="text-gray-400 text-sm font-medium">Active Coupons</h3>
                        <p class="text-3xl font-bold text-blue-400 mt-2">{{ financeStats.coupons?.active }} <span class="text-sm text-gray-500">/ {{ financeStats.coupons?.total }}</span></p>
                    </div>
                </div>

                <div v-if="financeTab === 'stats'" class="glass mt-6 p-6 rounded-xl border border-nexus-700">
                    <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                        <i data-lucide="chart-pie" class="w-5 h-5 text-nexus-400"></i>
                        Spend By Source
                    </h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-sm">
                            <thead class="bg-nexus-900/50 text-gray-200 uppercase text-xs">
                                <tr>
                                    <th class="p-3">Source</th>
                                    <th class="p-3 text-right">Total Spent</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-nexus-700">
                                <tr v-for="(amount, src) in financeStats.spend_by_source" :key="src" class="hover:bg-nexus-800/30">
                                    <td class="p-3 font-mono text-xs text-gray-300">{{ src }}</td>
                                    <td class="p-3 text-right text-red-400 font-bold">${{ amount.toFixed(2) }}</td>
                                </tr>
                                <tr v-if="!financeStats.spend_by_source || Object.keys(financeStats.spend_by_source).length === 0">
                                    <td colspan="2" class="p-4 text-center text-gray-500 text-sm">No spend data yet.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Transactions Tab -->
                <div v-if="financeTab === 'transactions'" class="space-y-4">
                    <div class="glass rounded-xl p-6 border border-nexus-700">
                        <div class="flex gap-4 mb-4">
                            <input v-model="financeFilters.user_id" placeholder="User ID" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <select v-model="financeFilters.type" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                                <option value="">All Types</option>
                                <option value="DEPOSIT">Deposit</option>
                                <option value="WITHDRAWAL">Withdrawal</option>
                                <option value="RESET">Reset</option>
                            </select>
                            <button @click="fetchTransactions" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold">Filter</button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="bg-nexus-900/50 text-gray-200 uppercase text-xs">
                                    <tr>
                                        <th class="p-3">ID</th>
                                        <th class="p-3">User ID</th>
                                        <th class="p-3">Type</th>
                                        <th class="p-3">Amount</th>
                                        <th class="p-3">Source</th>
                                        <th class="p-3">Date</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-nexus-700">
                                    <tr v-for="t in transactions" :key="t.id" class="hover:bg-nexus-800/30">
                                        <td class="p-3 font-mono text-gray-400">#{{ t.id }}</td>
                                        <td class="p-3 text-blue-400">{{ t.user_id }}</td>
                                        <td class="p-3">
                                            <span :class="{'text-green-400': t.type === 'DEPOSIT', 'text-red-400': t.type === 'WITHDRAWAL' || t.type === 'RESET'}">{{ t.type }}</span>
                                        </td>
                                        <td class="p-3 font-bold text-white">{{ t.amount }}</td>
                                        <td class="p-3 text-gray-400">{{ t.source }}</td>
                                        <td class="p-3 text-gray-500">{{ new Date(t.created_at).toLocaleString() }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Coupons Tab -->
                <div v-if="financeTab === 'coupons'" class="space-y-4">
                    <div class="glass rounded-xl p-6 border border-nexus-700">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-white">Coupons</h3>
                            <div class="flex gap-2">
                                <input v-model="newCoupon.code" placeholder="Custom Code (Optional)" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                                <input v-model.number="newCoupon.amount" type="number" placeholder="Amount" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none w-24">
                                <button @click="createCoupon" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold flex items-center gap-2">
                                    <i data-lucide="plus" class="w-4 h-4"></i> Create
                                </button>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="bg-nexus-900/50 text-gray-200 uppercase text-xs">
                                    <tr>
                                        <th class="p-3">Code</th>
                                        <th class="p-3">Amount</th>
                                        <th class="p-3">Status</th>
                                        <th class="p-3">Used By</th>
                                        <th class="p-3 text-right">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-nexus-700">
                                    <tr v-for="c in coupons" :key="c.code" class="hover:bg-nexus-800/30">
                                        <td class="p-3 font-mono text-yellow-400">{{ c.code }}</td>
                                        <td class="p-3 font-bold text-white">${{ c.amount }}</td>
                                        <td class="p-3">
                                            <span :class="c.is_used ? 'bg-red-500/20 text-red-300' : 'bg-green-500/20 text-green-300'" class="px-2 py-0.5 rounded text-xs font-bold uppercase">{{ c.is_used ? 'Used' : 'Active' }}</span>
                                        </td>
                                        <td class="p-3 text-gray-400">{{ c.used_by || '-' }}</td>
                                        <td class="p-3 text-right">
                                            <button @click="deleteCoupon(c.code)" class="text-red-400 hover:text-red-300 transition-colors"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Wallet Reset Tab -->
                <div v-if="financeTab === 'reset'" class="flex justify-center">
                    <div class="glass w-full max-w-lg rounded-xl border border-red-900/50 p-8 space-y-6 text-center">
                        <div class="w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto">
                            <i data-lucide="alert-triangle" class="w-8 h-8 text-red-500"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-white">Danger Zone: Reset All Wallets</h3>
                        <p class="text-gray-400">This action will reset the balance of ALL users to 0. A snapshot will be created for recovery purposes. This action cannot be undone easily.</p>
                        
                        <div class="space-y-4 text-left bg-nexus-900/50 p-6 rounded-lg border border-nexus-800">
                            <label class="block text-xs font-medium text-gray-400 uppercase">Admin Password Confirmation</label>
                            <input v-model="walletResetPassword" type="password" placeholder="Enter your password to confirm" class="w-full bg-nexus-900 border border-nexus-700 rounded px-4 py-3 text-white text-sm focus:border-red-500 outline-none">
                        </div>

                        <button @click="resetWallets" :disabled="!walletResetPassword" class="w-full bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-bold shadow-lg shadow-red-900/20 flex items-center justify-center gap-2">
                            <i data-lucide="trash" class="w-5 h-5"></i> Confirm Reset All Wallets
                        </button>
                    </div>
                </div>

                <!-- Finance Settings Tab -->
                <div v-if="financeTab === 'settings'" class="space-y-6">
                    <!-- Request Pricing -->
                    <div class="glass rounded-xl p-6 border border-nexus-700">
                        <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                            <i data-lucide="dollar-sign" class="w-5 h-5 text-nexus-400"></i> Request Pricing
                        </h3>
                        <div class="max-w-md space-y-4">
                            <div>
                                <label class="text-sm text-gray-400 block mb-2">Cost per Request ($)</label>
                                <div class="flex gap-2">
                                    <input v-model="requestPrice" type="number" step="0.01" class="flex-1 bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                                    <button @click="saveRequestPrice" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold">Save</button>
                                </div>
                                <p class="text-xs text-gray-500 mt-1">Set the base cost for each S2S request.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Manual Balance -->
                    <div class="glass rounded-xl p-6 border border-nexus-700">
                        <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                            <i data-lucide="wallet" class="w-5 h-5 text-nexus-400"></i> Manual Balance Add
                        </h3>
                        <div class="max-w-md space-y-4">
                            <div class="space-y-2">
                                <input v-model="manualBalanceForm.user_id" placeholder="User ID" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                                <div class="flex gap-2">
                                    <input v-model="manualBalanceForm.amount" type="number" placeholder="Amount" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                                    <button @click="addBalanceManual" class="bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded text-sm font-bold"><i data-lucide="plus" class="w-4 h-4"></i> Add</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reset Expenses -->
                    <div class="glass rounded-xl p-6 border border-red-900/50">
                        <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                            <i data-lucide="refresh-cw" class="w-5 h-5 text-red-400"></i> Reset Expenses Tracking
                        </h3>
                        <p class="text-sm text-gray-400 mb-6">This will reset the "Total Withdrawals" counter only. Transactions history and user balances will NOT be affected.</p>
                        
                        <div class="max-w-md space-y-4">
                             <div class="space-y-2 text-left bg-nexus-900/50 p-4 rounded-lg border border-nexus-800">
                                <label class="block text-xs font-medium text-gray-400 uppercase">Admin Password Confirmation</label>
                                <input v-model="expensesResetPassword" type="password" placeholder="Enter password" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-red-500 outline-none">
                            </div>
                            <button @click="resetExpenses" :disabled="!expensesResetPassword" class="bg-red-600 hover:bg-red-700 disabled:opacity-50 text-white px-4 py-2 rounded text-sm font-bold flex items-center gap-2">
                                <i data-lucide="trash-2" class="w-4 h-4"></i> Confirm Reset Expenses
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Store Management View -->
            <div v-if="false" class="p-8 space-y-8">
                <header class="flex justify-between items-center mb-8">
                    <div>
                        <h2 class="text-3xl font-bold text-white">ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ™ÿ¨ÿ±</h2>
                        <p class="text-gray-400 mt-1">ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÇŸÜŸàÿßÿ™ÿå ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖÿå Ÿàÿ™ÿ≥ÿπŸäÿ±/ŸÜÿ¥ÿ± ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ</p>
                    </div>
                    <button @click="fetchStoreAll" class="p-2 bg-nexus-700 rounded-lg hover:bg-nexus-600"><i data-lucide="refresh-cw" class="w-5 h-5"></i></button>
                </header>

                <div class="flex gap-4 border-b border-nexus-700 pb-4">
                    <button @click="storeAdminTab = 'channels'" :class="storeAdminTab === 'channels' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">
                        <i data-lucide="radio" class="w-4 h-4 inline mr-2"></i> ÿßŸÑŸÇŸÜŸàÿßÿ™
                    </button>
                    <button @click="storeAdminTab = 'categories'" :class="storeAdminTab === 'categories' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">
                        <i data-lucide="layers" class="w-4 h-4 inline mr-2"></i> ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ
                    </button>
                    <button @click="storeAdminTab = 'items'" :class="storeAdminTab === 'items' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">
                        <i data-lucide="package" class="w-4 h-4 inline mr-2"></i> ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ
                    </button>
                </div>

                <div v-if="storeAdminTab === 'channels'" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2">
                            <i data-lucide="hash" class="w-5 h-5 text-nexus-400"></i> ŸÇŸÜŸàÿßÿ™ ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ
                        </h3>
                        <p class="text-sm text-gray-400">ÿ£ÿØÿÆŸÑ ŸÖÿπÿ±ŸëŸÅÿßÿ™ ÿßŸÑŸÇŸÜŸàÿßÿ™ (Chat ID) ÿ≥ÿ∑ÿ± ŸÑŸÉŸÑ ŸÇŸÜÿßÿ©. Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ÿßŸÑÿ®Ÿàÿ™ ŸÖÿ¥ÿ±ŸÅÿßŸã ÿØÿßÿÆŸÑ Ÿáÿ∞Ÿá ÿßŸÑŸÇŸÜŸàÿßÿ™.</p>
                        <textarea v-model="storeChannelsText" rows="8" placeholder="-1001234567890" class="w-full bg-nexus-900/50 border border-nexus-700 rounded-lg p-3 text-white text-sm focus:border-nexus-500 outline-none resize-none font-mono"></textarea>
                        <div class="flex gap-3">
                            <button @click="saveStoreChannels" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold">ÿ≠ŸÅÿ∏</button>
                            <button @click="fetchStoreChannels" class="bg-nexus-700 hover:bg-nexus-600 text-white px-4 py-2 rounded text-sm font-bold">ÿ™ÿ≠ÿØŸäÿ´</button>
                        </div>
                    </div>
                    <div class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2">
                            <i data-lucide="info" class="w-5 h-5 text-nexus-400"></i> ŸÖŸÑÿßÿ≠ÿ∏ÿ©
                        </h3>
                        <div class="text-sm text-gray-400 space-y-2">
                            <div>Ÿäÿ™ŸÖ ÿ•ÿØÿÆÿßŸÑ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿπŸÜÿØ ŸÜÿ¥ÿ± ŸÖŸÑŸÅ ÿ¨ÿØŸäÿØ ŸÅŸä ÿßŸÑŸÇŸÜÿßÿ©.</div>
                            <div>ÿßŸÑŸÖŸÑŸÅÿßÿ™ ÿ™Ÿèÿ∂ÿßŸÅ ÿßŸÅÿ™ÿ±ÿßÿ∂ŸäÿßŸã ŸÉŸÄ ÿ∫Ÿäÿ± ŸÖŸÜÿ¥Ÿàÿ±ÿ© ÿ≠ÿ™Ÿâ Ÿäÿ™ŸÖ ÿ™ÿµŸÜŸäŸÅŸáÿß Ÿàÿ™ÿ≥ÿπŸäÿ±Ÿáÿß ÿ´ŸÖ ŸÜÿ¥ÿ±Ÿáÿß.</div>
                        </div>
                    </div>
                </div>

                <div v-if="storeAdminTab === 'categories'" class="space-y-6">
                    <div class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-bold text-white flex items-center gap-2">
                                <i data-lucide="layers" class="w-5 h-5 text-nexus-400"></i> ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ
                            </h3>
                            <button @click="fetchStoreCategories" class="text-xs bg-nexus-800 hover:bg-nexus-700 p-1 rounded"><i data-lucide="refresh-cw" class="w-3 h-3"></i></button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="bg-nexus-900/50 text-gray-200 uppercase text-xs">
                                    <tr>
                                        <th class="p-3">ID</th>
                                        <th class="p-3">Name</th>
                                        <th class="p-3">Slug</th>
                                        <th class="p-3">Order</th>
                                        <th class="p-3">Items</th>
                                        <th class="p-3 text-right">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-nexus-700">
                                    <tr v-for="c in storeCategories" :key="c.id" class="hover:bg-nexus-800/30">
                                        <td class="p-3 font-mono text-xs text-gray-300">{{ c.id }}</td>
                                        <td class="p-3"><input v-model="c.name" class="w-full bg-nexus-900 border border-nexus-700 rounded px-2 py-1 text-white text-sm"></td>
                                        <td class="p-3"><input v-model="c.slug" class="w-full bg-nexus-900 border border-nexus-700 rounded px-2 py-1 text-white text-sm font-mono"></td>
                                        <td class="p-3"><input v-model.number="c.sort_order" type="number" class="w-24 bg-nexus-900 border border-nexus-700 rounded px-2 py-1 text-white text-sm"></td>
                                        <td class="p-3 text-gray-400">{{ c.items }}</td>
                                        <td class="p-3 text-right space-x-2">
                                            <button @click="saveStoreCategory(c)" class="bg-green-600 hover:bg-green-500 text-white px-3 py-1 rounded text-xs font-bold">Save</button>
                                            <button @click="toggleStoreCategory(c)" :class="c.is_active ? 'bg-nexus-700 hover:bg-nexus-600' : 'bg-red-600 hover:bg-red-500'" class="text-white px-3 py-1 rounded text-xs font-bold">{{ c.is_active ? 'Active' : 'Disabled' }}</button>
                                        </td>
                                    </tr>
                                    <tr v-if="storeCategories.length === 0">
                                        <td colspan="6" class="p-4 text-center text-gray-500">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ£ŸÇÿ≥ÿßŸÖ.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2">
                            <i data-lucide="plus-circle" class="w-5 h-5 text-nexus-400"></i> ÿ•ÿ∂ÿßŸÅÿ© ŸÇÿ≥ŸÖ ÿ¨ÿØŸäÿØ
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                            <input v-model="newStoreCategory.name" placeholder="ÿßŸÑÿßÿ≥ŸÖ" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                            <input v-model="newStoreCategory.slug" placeholder="slug (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm font-mono">
                            <input v-model.number="newStoreCategory.sort_order" type="number" placeholder="order" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                            <button @click="createStoreCategory" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold">Create</button>
                        </div>
                    </div>
                </div>

                <div v-if="storeAdminTab === 'items'" class="space-y-6">
                    <div class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                        <div class="flex flex-wrap gap-3 items-center">
                            <input v-model="storeItemFilters.q" placeholder="ÿ®ÿ≠ÿ´ ÿ®ÿßŸÑÿπŸÜŸàÿßŸÜ..." class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <select v-model.number="storeItemFilters.category_id" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                                <option :value="0">ŸÉŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ</option>
                                <option v-for="c in storeCategories" :key="c.id" :value="c.id">{{ c.name }}</option>
                            </select>
                            <select v-model="storeItemFilters.status" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                                <option value="all">ÿßŸÑŸÉŸÑ</option>
                                <option value="draft">ÿ∫Ÿäÿ± ŸÖŸÜÿ¥Ÿàÿ±</option>
                                <option value="published">ŸÖŸÜÿ¥Ÿàÿ±</option>
                            </select>
                            <button @click="fetchStoreItems" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold">ÿ™ÿ≠ÿØŸäÿ´</button>
                            <div class="text-xs text-gray-400">Total: {{ storeItemsTotal }}</div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="bg-nexus-900/50 text-gray-200 uppercase text-xs">
                                    <tr>
                                        <th class="p-3">ID</th>
                                        <th class="p-3">Title</th>
                                        <th class="p-3">Category</th>
                                        <th class="p-3">Price</th>
                                        <th class="p-3">Status</th>
                                        <th class="p-3">Source</th>
                                        <th class="p-3 text-right">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-nexus-700">
                                    <tr v-for="it in storeItems" :key="it.id" class="hover:bg-nexus-800/30">
                                        <td class="p-3 font-mono text-xs text-gray-300">{{ it.id }}</td>
                                        <td class="p-3 text-white truncate max-w-[360px]" :title="it.title">{{ it.title }}</td>
                                        <td class="p-3 text-gray-300">{{ it.category_name || '-' }}</td>
                                        <td class="p-3 text-green-400 font-bold">${{ (it.price || 0).toFixed(2) }}</td>
                                        <td class="p-3">
                                            <span :class="it.is_active ? 'bg-green-500/20 text-green-300' : 'bg-red-500/20 text-red-300'" class="px-2 py-0.5 rounded text-xs font-bold uppercase">{{ it.is_active ? 'Published' : 'Draft' }}</span>
                                        </td>
                                        <td class="p-3 text-xs font-mono text-gray-400">
                                            <a v-if="it.message_link" :href="it.message_link" target="_blank" class="text-blue-400 hover:text-blue-300">Message</a>
                                            <span v-else>‚Äî</span>
                                        </td>
                                        <td class="p-3 text-right">
                                            <button @click="openStoreItemModal(it)" class="bg-nexus-700 hover:bg-nexus-600 text-white px-3 py-1 rounded text-xs font-bold">Edit</button>
                                        </td>
                                    </tr>
                                    <tr v-if="storeItems.length === 0">
                                        <td colspan="7" class="p-4 text-center text-gray-500">ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖÿ≠ÿ™ŸàŸâ.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="flex justify-between items-center text-sm text-gray-400">
                        <div>Offset: {{ storeItemsOffset }}</div>
                        <div class="flex gap-2">
                            <button @click="storeItemsPrev" :disabled="storeItemsOffset === 0" class="px-3 py-1 rounded border border-nexus-700 hover:border-nexus-500 disabled:opacity-40 disabled:hover:border-nexus-700">Prev</button>
                            <button @click="storeItemsNext" :disabled="storeItemsOffset + storeItemsLimit >= storeItemsTotal" class="px-3 py-1 rounded border border-nexus-700 hover:border-nexus-500 disabled:opacity-40 disabled:hover:border-nexus-700">Next</button>
                        </div>
                    </div>
                </div>

                <div v-if="showStoreItemModal" class="fixed inset-0 z-[70] flex items-center justify-center bg-black/80 backdrop-blur-md p-4">
                    <div class="glass w-full max-w-2xl rounded-xl border border-nexus-700 p-6 space-y-4">
                        <div class="flex justify-between items-center">
                            <h3 class="text-xl font-bold text-white flex items-center gap-2">
                                <i data-lucide="package" class="w-5 h-5 text-nexus-400"></i> ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ #{{ storeItemForm.id }}
                            </h3>
                            <button @click="showStoreItemModal = false" class="text-gray-400 hover:text-white"><i data-lucide="x" class="w-5 h-5"></i></button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-2">
                                <label class="text-xs text-gray-500 font-bold uppercase">Title</label>
                                <input v-model="storeItemForm.title" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                            </div>
                            <div class="space-y-2">
                                <label class="text-xs text-gray-500 font-bold uppercase">Price ($)</label>
                                <input v-model.number="storeItemForm.price" type="number" step="0.01" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                            </div>
                            <div class="space-y-2 md:col-span-2">
                                <label class="text-xs text-gray-500 font-bold uppercase">Description</label>
                                <textarea v-model="storeItemForm.description" rows="4" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm resize-none"></textarea>
                            </div>
                            <div class="space-y-2">
                                <label class="text-xs text-gray-500 font-bold uppercase">Category</label>
                                <select v-model.number="storeItemForm.category_id" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                                    <option :value="0">ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ</option>
                                    <option v-for="c in storeCategories" :key="c.id" :value="c.id">{{ c.name }}</option>
                                </select>
                            </div>
                            <div class="space-y-2">
                                <label class="text-xs text-gray-500 font-bold uppercase">Publish</label>
                                <select v-model="storeItemForm.is_active" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm">
                                    <option :value="false">Draft</option>
                                    <option :value="true">Published</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex justify-end gap-3 pt-2">
                            <button @click="showStoreItemModal = false" class="text-gray-400 hover:text-white text-sm">Cancel</button>
                            <button @click="saveStoreItem" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold">Save</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Store View -->
            <div v-if="currentTab === 'store'" class="p-4 md:p-8 space-y-6">
                <header class="flex justify-between items-center">
                    <div>
                        <h2 class="text-3xl font-bold text-white">ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ™ÿ¨ÿ±</h2>
                        <p class="text-gray-400 mt-1">ŸÇŸÜŸàÿßÿ™ ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØÿå ÿßŸÑÿ™ÿµŸÜŸäŸÅÿå ÿßŸÑÿ™ÿ≥ÿπŸäÿ±ÿå ÿßŸÑŸÜÿ¥ÿ±ÿå ŸàÿßŸÑŸÖÿ¥ÿ™ÿ±Ÿäÿßÿ™</p>
                    </div>
                </header>

                <div class="flex gap-4 border-b border-nexus-700 pb-4">
                    <button @click="storeTab = 'items'" :class="storeTab === 'items' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ</button>
                    <button @click="storeTab = 'channels'" :class="storeTab === 'channels' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">ÿßŸÑŸÇŸÜŸàÿßÿ™</button>
                    <button @click="storeTab = 'categories'" :class="storeTab === 'categories' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ</button>
                    <button @click="storeTab = 'purchases'" :class="storeTab === 'purchases' ? 'bg-nexus-500 text-white' : 'bg-nexus-800 text-gray-400'" class="px-4 py-2 rounded-lg font-bold transition-colors">ÿßŸÑŸÖÿ¥ÿ™ÿ±Ÿäÿßÿ™</button>
                </div>

                <div v-if="storeTab === 'channels'" class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="radio" class="w-5 h-5 text-nexus-400"></i> ŸÇŸÜŸàÿßÿ™ ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ</h3>
                        <button @click="fetchStoreChannels" class="text-xs bg-nexus-800 hover:bg-nexus-700 p-1 rounded"><i data-lucide="refresh-cw" class="w-3 h-3"></i></button>
                    </div>
                    <div class="text-xs text-gray-500">ÿ∂ÿπ ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÇŸÜÿßÿ© (t.me/channelUsername) ÿ£Ÿà ŸäŸàÿ≤ÿ± ÿßŸÑŸÇŸÜÿßÿ© (@channel) ÿ£Ÿà ÿßŸÑŸÄ ID (-100...) ÿ≥ÿ∑ÿ± ŸÑŸÉŸÑ ŸÇŸÜÿßÿ©.</div>
                    <textarea v-model="storeChannelsText" rows="6" class="w-full bg-nexus-900/50 border border-nexus-700 rounded-lg p-3 text-white text-sm focus:border-nexus-500 outline-none resize-none font-mono" placeholder="https://t.me/MyChannel&#10;@MyChannel&#10;-1001234567890"></textarea>
                    <div class="flex gap-2">
                        <button @click="saveStoreChannels" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-bold">ÿ≠ŸÅÿ∏</button>
                        <button @click="scanStoreChannels" class="bg-yellow-600 hover:bg-yellow-500 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2">
                            <i data-lucide="scan" class="w-4 h-4"></i> ŸÅÿ≠ÿµ ÿßŸÑÿ±ÿ®ÿ∑ ÿßŸÑÿ¢ŸÜ
                        </button>
                        <button @click="testStoreIngest" class="bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2">
                            <i data-lucide="image" class="w-4 h-4"></i> ÿßÿÆÿ™ÿ®ÿßÿ± ÿ•ÿØÿÆÿßŸÑ
                        </button>
                    </div>
                    <div class="space-y-3 pt-2">
                        <div class="text-xs text-gray-400">ÿßŸÑŸÇŸÜŸàÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©: <span class="font-mono text-gray-200">{{ (storeChannelsCurrent || []).join(', ') || '‚Äî' }}</span></div>
                        <div class="glass rounded-lg border border-nexus-700 p-3">
                            <div class="flex justify-between items-center mb-2">
                                <div class="text-xs font-bold text-gray-300 uppercase">ÿ≥ÿ¨ŸÑ ÿßŸÑŸÇŸÜŸàÿßÿ™</div>
                                <button @click="fetchStoreChannelsLog" class="text-xs bg-nexus-800 hover:bg-nexus-700 px-2 py-1 rounded">ÿ™ÿ≠ÿØŸäÿ´</button>
                            </div>
                            <div v-if="storeChannelsLog.length === 0" class="text-xs text-gray-500">ŸÑÿß ŸäŸàÿ¨ÿØ ÿ≥ÿ¨ŸÑ.</div>
                            <div v-else class="space-y-2">
                                <div v-for="l in storeChannelsLog" :key="l.id" class="text-xs text-gray-300 flex justify-between gap-4 border-b border-nexus-800 pb-2 last:border-b-0 last:pb-0">
                                    <div class="text-gray-500 whitespace-nowrap">{{ l.time }}</div>
                                    <div class="font-mono text-right flex-1">{{ (l.channels || []).join(', ') }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div v-if="storeTab === 'categories'" class="space-y-4">
                    <div class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="layout-list" class="w-5 h-5 text-nexus-400"></i> ÿ£ŸÇÿ≥ÿßŸÖ ÿßŸÑŸÖÿ™ÿ¨ÿ±</h3>
                            <button @click="fetchStoreCategories" class="text-xs bg-nexus-800 hover:bg-nexus-700 p-1 rounded"><i data-lucide="refresh-cw" class="w-3 h-3"></i></button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                            <input v-model="storeNewCategory.name" placeholder="ÿßÿ≥ŸÖ ÿßŸÑŸÇÿ≥ŸÖ" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <input v-model="storeNewCategory.slug" placeholder="slug (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <input v-model.number="storeNewCategory.sort_order" type="number" placeholder="ÿ™ÿ±ÿ™Ÿäÿ®" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <button @click="createStoreCategory" class="bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded text-sm font-bold">ÿ•ÿ∂ÿßŸÅÿ©</button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="text-gray-400 border-b border-nexus-700">
                                    <tr>
                                        <th class="py-2 pr-4">ID</th>
                                        <th class="py-2 pr-4">ÿßŸÑÿßÿ≥ŸÖ</th>
                                        <th class="py-2 pr-4">Slug</th>
                                        <th class="py-2 pr-4 text-right">ÿ™ÿ±ÿ™Ÿäÿ®</th>
                                        <th class="py-2 pr-4">ÿßŸÑÿ≠ÿßŸÑÿ©</th>
                                        <th class="py-2 pr-4 text-right">ÿ•ÿ¨ÿ±ÿßÿ°</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300 divide-y divide-nexus-800">
                                    <tr v-for="c in storeCategories" :key="c.id" class="hover:bg-nexus-800/30">
                                        <td class="py-2 pr-4 font-mono text-xs">#{{ c.id }}</td>
                                        <td class="py-2 pr-4">{{ c.name }}</td>
                                        <td class="py-2 pr-4 font-mono text-xs text-gray-400">{{ c.slug }}</td>
                                        <td class="py-2 pr-4 text-right font-mono text-xs">{{ c.sort_order }}</td>
                                        <td class="py-2 pr-4">
                                            <span :class="c.is_active ? 'text-green-400' : 'text-red-400'" class="text-xs font-bold">{{ c.is_active ? 'ACTIVE' : 'DISABLED' }}</span>
                                        </td>
                                        <td class="py-2 pr-4 text-right">
                                            <button @click="toggleStoreCategory(c)" class="text-xs bg-nexus-800 hover:bg-nexus-700 px-2 py-1 rounded">{{ c.is_active ? 'Disable' : 'Enable' }}</button>
                                        </td>
                                    </tr>
                                    <tr v-if="storeCategories.length === 0">
                                        <td colspan="6" class="py-4 text-center text-gray-500">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ£ŸÇÿ≥ÿßŸÖ</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div v-if="storeTab === 'items'" class="space-y-4">
                    <div class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="package" class="w-5 h-5 text-nexus-400"></i> ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿ™ÿ¨ÿ±</h3>
                            <button @click="fetchStoreItems" class="text-xs bg-nexus-800 hover:bg-nexus-700 p-1 rounded"><i data-lucide="refresh-cw" class="w-3 h-3"></i></button>
                        </div>
                        <div class="flex flex-wrap gap-3">
                            <select v-model="storeItemsStatus" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                                <option value="unpublished">ÿ∫Ÿäÿ± ŸÖŸÜÿ¥Ÿàÿ±</option>
                                <option value="published">ŸÖŸÜÿ¥Ÿàÿ±</option>
                            </select>
                            <input v-model="storeItemsQuery" placeholder="ÿ®ÿ≠ÿ´ ÿ®ÿßŸÑÿπŸÜŸàÿßŸÜ..." class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <button @click="fetchStoreItems" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold">ÿ™ÿ∑ÿ®ŸäŸÇ</button>
                            <div class="text-xs text-gray-500 flex items-center">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: {{ storeItemsTotal }}</div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="text-gray-400 border-b border-nexus-700">
                                    <tr>
                                        <th class="py-2 pr-4">ID</th>
                                        <th class="py-2 pr-4">ÿßŸÑÿπŸÜŸàÿßŸÜ</th>
                                        <th class="py-2 pr-4">ÿßŸÑŸÇÿ≥ŸÖ</th>
                                        <th class="py-2 pr-4 text-right">ÿßŸÑÿ≥ÿπÿ±</th>
                                        <th class="py-2 pr-4">ÿßŸÑÿ≠ÿßŸÑÿ©</th>
                                        <th class="py-2 pr-4 text-right">ÿ•ÿ¨ÿ±ÿßÿ°</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300 divide-y divide-nexus-800">
                                    <tr v-for="it in storeItems" :key="it.id" class="hover:bg-nexus-800/30">
                                        <td class="py-2 pr-4 font-mono text-xs">#{{ it.id }}</td>
                                        <td class="py-2 pr-4">
                                            <input v-model="it.title" class="w-full bg-nexus-900 border border-nexus-700 rounded px-2 py-1 text-white text-xs focus:border-nexus-500 outline-none">
                                            <div class="text-[10px] text-gray-500 font-mono mt-1">{{ it.file_type }} | {{ it.file_name || '-' }} | {{ it.source_chat_id }}:{{ it.source_message_id }}</div>
                                        </td>
                                        <td class="py-2 pr-4">
                                            <select v-model="it.category_id" class="bg-nexus-900 border border-nexus-700 rounded px-2 py-1 text-white text-xs focus:border-nexus-500 outline-none">
                                                <option :value="null">--</option>
                                                <option v-for="c in storeCategories" :key="c.id" :value="c.id">{{ c.name }}</option>
                                            </select>
                                        </td>
                                        <td class="py-2 pr-4 text-right">
                                            <input v-model.number="it.price" type="number" step="0.01" class="w-28 bg-nexus-900 border border-nexus-700 rounded px-2 py-1 text-white text-xs text-right focus:border-nexus-500 outline-none">
                                        </td>
                                        <td class="py-2 pr-4">
                                            <label class="inline-flex items-center gap-2 text-xs">
                                                <input type="checkbox" v-model="it.is_active" class="accent-blue-600">
                                                <span :class="it.is_active ? 'text-green-400' : 'text-red-400'" class="font-bold">{{ it.is_active ? 'PUBLISHED' : 'DRAFT' }}</span>
                                            </label>
                                        </td>
                                        <td class="py-2 pr-4 text-right">
                                            <div class="flex justify-end gap-2">
                                                <button @click="openStoreItemEditor(it)" class="text-xs bg-nexus-800 hover:bg-nexus-700 text-white px-3 py-1 rounded">ÿ™ÿ≠ÿ±Ÿäÿ±</button>
                                                <button @click="saveStoreItem(it)" class="text-xs bg-green-600 hover:bg-green-500 text-white px-3 py-1 rounded">ÿ≠ŸÅÿ∏</button>
                                                <button @click="deleteStoreItem(it)" class="text-xs bg-red-700 hover:bg-red-600 text-white px-3 py-1 rounded">ÿ≠ÿ∞ŸÅ</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr v-if="storeItems.length === 0">
                                        <td colspan="6" class="py-4 text-center text-gray-500">ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖÿ≠ÿ™ŸàŸâ</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div v-if="showStoreItemEditor && storeItemEdit" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4" @click.self="closeStoreItemEditor">
                    <div class="glass rounded-xl border border-nexus-700 w-full max-w-3xl p-6 space-y-4">
                        <div class="flex justify-between items-center">
                            <div class="text-lg font-bold text-white">ÿ™ÿ≠ÿ±Ÿäÿ± ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ #{{ storeItemEdit?.id }}</div>
                            <button @click="closeStoreItemEditor" class="text-gray-400 hover:text-white">‚úï</button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-3">
                                <div class="text-xs text-gray-400 font-mono">
                                    {{ storeItemEdit?.file_type }} | {{ storeItemEdit?.file_name || '-' }} | {{ storeItemEdit?.source_chat_id }}:{{ storeItemEdit?.source_message_id }}
                                </div>
                                <div>
                                    <div class="text-xs text-gray-400 mb-1">ÿßŸÑÿπŸÜŸàÿßŸÜ</div>
                                    <input v-model="storeItemEdit.title" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                                </div>
                                <div>
                                    <div class="text-xs text-gray-400 mb-1">ÿßŸÑŸàÿµŸÅ</div>
                                    <textarea v-model="storeItemEdit.description" rows="5" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none resize-none"></textarea>
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <div class="text-xs text-gray-400 mb-1">ÿßŸÑŸÇÿ≥ŸÖ</div>
                                        <select v-model="storeItemEdit.category_id" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                                            <option :value="null">--</option>
                                            <option v-for="c in storeCategories" :key="c.id" :value="c.id">{{ c.name }}</option>
                                        </select>
                                    </div>
                                    <div>
                                        <div class="text-xs text-gray-400 mb-1">ÿßŸÑÿ≥ÿπÿ±</div>
                                        <input v-model.number="storeItemEdit.price" type="number" step="0.01" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm text-right focus:border-nexus-500 outline-none">
                                    </div>
                                </div>
                                <label class="inline-flex items-center gap-2 text-sm text-white">
                                    <input type="checkbox" v-model="storeItemEdit.is_active" class="accent-blue-600">
                                    <span :class="storeItemEdit.is_active ? 'text-green-400' : 'text-red-400'" class="font-bold">{{ storeItemEdit.is_active ? 'PUBLISHED' : 'DRAFT' }}</span>
                                </label>
                            </div>
                            <div class="space-y-3">
                                <div class="text-xs text-gray-400">ŸÖÿπÿßŸäŸÜÿ©</div>
                                <div class="bg-nexus-900/50 border border-nexus-700 rounded-lg p-3 min-h-[260px] flex items-center justify-center">
                                    <div v-if="storeItemPreviewLoading" class="text-xs text-gray-500">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...</div>
                                    <div v-else-if="!storeItemPreviewUrl" class="text-xs text-gray-500">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿπÿßŸäŸÜÿ©</div>
                                    <img v-else-if="(storeItemEdit?.file_type || '') === 'photo'" :src="storeItemPreviewUrl" class="max-h-[340px] rounded">
                                    <video v-else-if="(storeItemEdit?.file_type || '') === 'video'" :src="storeItemPreviewUrl" class="w-full max-h-[340px] rounded" controls></video>
                                    <audio v-else-if="(storeItemEdit?.file_type || '') === 'audio' || (storeItemEdit?.file_type || '') === 'voice'" :src="storeItemPreviewUrl" class="w-full" controls></audio>
                                    <a v-else :href="storeItemPreviewUrl" target="_blank" class="text-nexus-300 hover:text-white text-sm underline">ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖŸÑŸÅ</a>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-end gap-2">
                            <button @click="closeStoreItemEditor" class="bg-nexus-800 hover:bg-nexus-700 text-white px-4 py-2 rounded text-sm font-bold">ÿ•ÿ∫ŸÑÿßŸÇ</button>
                            <button @click="saveStoreItemFromEditor" class="bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded text-sm font-bold">ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™</button>
                        </div>
                    </div>
                </div>

                <div v-if="storeTab === 'purchases'" class="space-y-4">
                    <div class="glass rounded-xl p-6 border border-nexus-700 space-y-4">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="receipt" class="w-5 h-5 text-nexus-400"></i> ÿ≥ÿ¨ŸÑ ÿßŸÑŸÖÿ¥ÿ™ÿ±Ÿäÿßÿ™</h3>
                            <button @click="fetchStorePurchases" class="text-xs bg-nexus-800 hover:bg-nexus-700 p-1 rounded"><i data-lucide="refresh-cw" class="w-3 h-3"></i></button>
                        </div>
                        <div class="flex flex-wrap gap-3">
                            <input v-model="storePurchasesFilters.user_id" placeholder="User ID (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <input v-model="storePurchasesFilters.item_id" placeholder="Item ID (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)" class="bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <button @click="fetchStorePurchases" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold">ÿ®ÿ≠ÿ´</button>
                            <div class="text-xs text-gray-500 flex items-center">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: {{ storePurchasesTotal }}</div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm">
                                <thead class="text-gray-400 border-b border-nexus-700">
                                    <tr>
                                        <th class="py-2 pr-4">ID</th>
                                        <th class="py-2 pr-4">User</th>
                                        <th class="py-2 pr-4">Item</th>
                                        <th class="py-2 pr-4 text-right">Paid</th>
                                        <th class="py-2 pr-4">Time</th>
                                    </tr>
                                </thead>
                                <tbody class="text-gray-300 divide-y divide-nexus-800">
                                    <tr v-for="p in storePurchases" :key="p.id" class="hover:bg-nexus-800/30">
                                        <td class="py-2 pr-4 font-mono text-xs">#{{ p.id }}</td>
                                        <td class="py-2 pr-4 font-mono text-xs">#{{ p.user_id }}</td>
                                        <td class="py-2 pr-4 font-mono text-xs">#{{ p.item_id }}</td>
                                        <td class="py-2 pr-4 text-right font-mono text-xs text-green-400">${{ (p.price_paid || 0).toFixed(2) }}</td>
                                        <td class="py-2 pr-4 text-xs text-gray-400">{{ new Date(p.created_at).toLocaleString() }}</td>
                                    </tr>
                                    <tr v-if="storePurchases.length === 0">
                                        <td colspan="5" class="py-4 text-center text-gray-500">ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖÿ¥ÿ™ÿ±Ÿäÿßÿ™</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bot Management View -->
            <div v-if="currentTab === 'bot_mgmt'" class="p-4 md:p-8 space-y-8">
                <header class="flex justify-between items-center mb-8">
                    <div>
                        <h2 class="text-3xl font-bold text-white">{{ t('bot_management') }}</h2>
                        <p class="text-gray-400 mt-1">Manage Bot Tokens and Access Control</p>
                    </div>
                </header>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Tokens Section -->
                    <div class="glass rounded-xl border border-nexus-700 p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-white flex items-center gap-2">
                                <i data-lucide="key" class="w-5 h-5 text-yellow-400"></i> Bot Tokens
                            </h3>
                            <button @click="showAddTokenModal = true" class="bg-nexus-700 hover:bg-nexus-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold transition-colors flex items-center gap-1">
                                <i data-lucide="plus" class="w-3 h-3"></i> Add Token
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm text-gray-400">
                                <thead class="bg-nexus-900/50 text-gray-200 uppercase text-xs">
                                    <tr>
                                        <th class="px-4 py-3 rounded-tl-lg">Name</th>
                                        <th class="px-4 py-3">Token</th>
                                        <th class="px-4 py-3 text-right rounded-tr-lg">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-nexus-700">
                                    <tr v-for="token in botTokens" :key="token.id" class="hover:bg-nexus-800/30 transition-colors">
                                        <td class="px-4 py-3 font-medium text-white">{{ token.name }}</td>
                                        <td class="px-4 py-3 font-mono text-xs">{{ token.token }}</td>
                                        <td class="px-4 py-3 text-right">
                                            <button @click="deleteBotToken(token.id)" class="text-red-400 hover:text-red-300 transition-colors"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </td>
                                    </tr>
                                    <tr v-if="botTokens.length === 0">
                                        <td colspan="3" class="px-4 py-6 text-center text-gray-500">No tokens found.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Access Control Section -->
                    <div class="glass rounded-xl border border-nexus-700 p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-white flex items-center gap-2">
                                <i data-lucide="users" class="w-5 h-5 text-blue-400"></i> Access Control
                            </h3>
                            <button @click="showAddAccessModal = true" class="bg-nexus-700 hover:bg-nexus-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold transition-colors flex items-center gap-1">
                                <i data-lucide="plus" class="w-3 h-3"></i> Add User
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm text-gray-400">
                                <thead class="bg-nexus-900/50 text-gray-200 uppercase text-xs">
                                    <tr>
                                        <th class="px-4 py-3 rounded-tl-lg">User ID</th>
                                        <th class="px-4 py-3">Role</th>
                                        <th class="px-4 py-3">Name</th>
                                        <th class="px-4 py-3 text-right rounded-tr-lg">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-nexus-700">
                                    <tr v-for="access in botAccessList" :key="access.id" class="hover:bg-nexus-800/30 transition-colors">
                                        <td class="px-4 py-3 font-mono text-xs text-white">{{ access.user_id }}</td>
                                        <td class="px-4 py-3">
                                            <span :class="access.role === 'admin' ? 'bg-red-500/20 text-red-300' : 'bg-blue-500/20 text-blue-300'" class="px-2 py-0.5 rounded text-xs font-bold uppercase">{{ access.role }}</span>
                                        </td>
                                        <td class="px-4 py-3">{{ access.name || '-' }}</td>
                                        <td class="px-4 py-3 text-right">
                                            <button @click="deleteBotAccess(access.id)" class="text-red-400 hover:text-red-300 transition-colors"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </td>
                                    </tr>
                                    <tr v-if="botAccessList.length === 0">
                                        <td colspan="4" class="px-4 py-6 text-center text-gray-500">No access rules defined.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add Bot Token Modal -->
            <div v-if="showAddTokenModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
                <div class="glass w-full max-w-md rounded-xl border border-nexus-700 p-6 space-y-4">
                    <h3 class="text-xl font-bold text-white">{{ t('add_token') }}</h3>
                    
                    <div class="space-y-3">
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">{{ t('token_name') }}</label>
                            <input v-model="newToken.name" :placeholder="t('token_name')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">{{ t('token_value') }}</label>
                            <input v-model="newToken.token" placeholder="123456:ABC-DEF..." class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none font-mono">
                        </div>
                    </div>

                    <div class="flex gap-3 justify-end mt-4">
                        <button @click="showAddTokenModal = false" class="text-gray-400 hover:text-white text-sm">{{ t('cancel') }}</button>
                        <button @click="addBotToken" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold shadow-lg shadow-blue-500/20">{{ t('save') }}</button>
                    </div>
                </div>
            </div>

            <!-- Add Bot Access Modal -->
            <div v-if="showAddAccessModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
                <div class="glass w-full max-w-md rounded-xl border border-nexus-700 p-6 space-y-4">
                    <h3 class="text-xl font-bold text-white">{{ t('add_user') }}</h3>
                    
                    <div class="space-y-3">
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">{{ t('user_id') }} (Telegram ID)</label>
                            <input v-model="newAccess.user_id" type="number" placeholder="123456789" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none font-mono">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">{{ t('name') }}</label>
                            <input v-model="newAccess.name" :placeholder="t('name')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">{{ t('role') }}</label>
                            <select v-model="newAccess.role" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                                <option value="editor">{{ t('editor') }}</option>
                                <option value="admin">{{ t('admin') }}</option>
                            </select>
                        </div>
                    </div>

                    <div class="flex gap-3 justify-end mt-4">
                        <button @click="showAddAccessModal = false" class="text-gray-400 hover:text-white text-sm">{{ t('cancel') }}</button>
                        <button @click="addBotAccess" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold shadow-lg shadow-blue-500/20">{{ t('save') }}</button>
                    </div>
                </div>
            </div>

            <!-- Add Balance All Modal -->
            <div v-if="showAddBalanceAllModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
                <div class="glass w-full max-w-md rounded-xl border border-nexus-700 p-6 space-y-4">
                    <h3 class="text-xl font-bold text-white">{{ t('add_balance_all') }}</h3>
                    <p class="text-sm text-gray-400">{{ t('add_balance_all_confirm') }}</p>
                    
                    <div>
                        <label class="text-xs text-gray-500 mb-1 block">{{ t('amount') }}</label>
                        <input v-model.number="addBalanceAllAmount" type="number" step="0.01" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                    </div>

                    <div class="flex gap-3 justify-end mt-4">
                        <button @click="showAddBalanceAllModal = false" class="text-gray-400 hover:text-white text-sm">{{ t('cancel') }}</button>
                        <button @click="addBalanceToAll" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold shadow-lg shadow-blue-500/20">{{ t('confirm') }}</button>
                    </div>
                </div>
            </div>

            <!-- Add Game Modal -->
            <div v-if="showAddGameModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
                <div class="glass w-full max-w-lg rounded-xl border border-nexus-700 p-6 space-y-4">
                    <h3 class="text-xl font-bold text-white">{{ t('add_new_game') }}</h3>
                    
                    <!-- Basic Info -->
                    <div class="space-y-3">
                        <input v-model="newGame.name" :placeholder="t('game_name')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="newGame.package_name" :placeholder="t('package_name') + ' (e.g. com.game.id)'" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <div class="flex items-center gap-2 bg-nexus-900 border border-nexus-700 rounded px-3 py-2">
                            <span class="text-gray-400 text-sm">$</span>
                            <input v-model="newGame.price" type="number" step="0.01" placeholder="Price (Cost)" class="w-full bg-transparent text-white text-sm focus:outline-none">
                        </div>
                    </div>

                    <!-- Provider Selection -->
                    <div>
                        <label class="text-xs text-gray-500 mb-1 block">{{ t('provider') }}</label>
                        <select v-model="newGame.provider" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <option value="AppsFlyer">AppsFlyer</option>
                            <option value="Adjust">Adjust</option>
                            <option value="Singular">Singular</option>
                        </select>
                    </div>

                    <div>
                        <label class="text-xs text-gray-500 mb-1 block">{{ t('device_os') }}</label>
                        <select v-model="newGame.device_os" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <option value="android">Android</option>
                            <option value="ios">iPhone (iOS)</option>
                        </select>
                    </div>

                    <!-- Provider Specifics -->
                    <div class="space-y-3 p-4 bg-nexus-900/50 rounded-lg border border-nexus-800">
                        <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider">{{ newGame.provider }} {{ t('provider_config') }}</h4>
                        
                        <!-- Main Key -->
                        <div>
                            <label class="text-xs text-nexus-400 mb-1 block font-bold">
                                {{ newGame.provider === 'Adjust' ? t('app_token') : (newGame.provider === 'Singular' ? t('api_key') : t('dev_key')) }}
                            </label>
                            <input v-model="newGame.main_key" :placeholder="newGame.provider === 'Adjust' ? 'e.g. abc123456789' : 'e.g. XyZ123...'" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none font-mono">
                        </div>

                        <!-- Advanced Data -->
                        <div>
                            <label class="text-xs text-nexus-400 mb-1 block font-bold">
                                {{ newGame.provider === 'Adjust' ? t('level_sequence') : (newGame.provider === 'Singular' ? t('secret_config') : t('event_template')) }}
                            </label>
                            <textarea v-model="newGame.advanced_data" rows="4" :placeholder="newGame.provider === 'Adjust' ? '1:token1\n5:token2\n10:token3' : (newGame.provider === 'Singular' ? 'Enter secret or JSON config...' : 'default')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none font-mono resize-none"></textarea>
                            <p class="text-xs text-gray-500 mt-1">
                                {{ newGame.provider === 'Adjust' ? t('format_adjust') : (newGame.provider === 'Singular' ? t('format_singular') : t('format_appsflyer')) }}
                            </p>
                        </div>
                    </div>

                    <div class="flex gap-3 justify-end mt-4">
                        <button @click="showAddGameModal = false" class="text-gray-400 hover:text-white text-sm">{{ t('cancel') }}</button>
                        <button @click="addGame" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold shadow-lg shadow-blue-500/20">{{ t('save') }}</button>
                    </div>
                </div>
            </div>

            <!-- Edit Game Modal -->
            <div v-if="showEditGameModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
                <div class="glass w-full max-w-lg rounded-xl border border-nexus-700 p-6 space-y-4 max-h-[90vh] overflow-y-auto">
                    <div class="flex items-center justify-between">
                        <h3 class="text-xl font-bold text-white">{{ t('edit_game') }}</h3>
                        <button @click="showEditGameModal = false" class="text-gray-400 hover:text-white p-1 rounded">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-3">
                        <input v-model="editGameData.name" :placeholder="t('game_name')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="editGameData.alias" placeholder="Game Key (Alias)" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <input v-model="editGameData.package_name" :placeholder="t('package_name')" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        <div class="flex items-center gap-2 bg-nexus-900 border border-nexus-700 rounded px-3 py-2">
                            <span class="text-gray-400 text-sm">$</span>
                            <input v-model="editGameData.price" type="number" step="0.01" placeholder="Price (Cost)" class="w-full bg-transparent text-white text-sm focus:outline-none">
                        </div>
                    </div>

                    <div>
                        <label class="text-xs text-gray-500 mb-1 block">{{ t('provider') }}</label>
                        <select v-model="editGameData.provider" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                            <option value="AppsFlyer">AppsFlyer</option>
                            <option value="Adjust">Adjust</option>
                            <option value="Singular">Singular</option>
                        </select>
                    </div>

                    <div class="flex items-center gap-2">
                        <input type="checkbox" v-model="editGameData.is_active" id="editGameActive" class="w-4 h-4 rounded bg-nexus-900 border-nexus-700 text-nexus-500 focus:ring-nexus-500">
                        <label for="editGameActive" class="text-sm text-gray-300">Is Active</label>
                    </div>

                    <!-- Core Configuration -->
                    <div class="space-y-3 p-4 bg-nexus-900/50 rounded-lg border border-nexus-800">
                        <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider">Core Configuration</h4>
                        
                        <!-- Common App ID / Token -->
                        <div>
                            <label class="text-xs text-gray-500 mb-1 block">
                                {{ editGameData.provider === 'Adjust' ? 'App Token (12 chars)' : 'App ID / Package Name' }}
                            </label>
                            <input v-model="editGameData.config_app_id" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none font-mono">
                        </div>

                        <!-- Provider Specifics -->
                        <div v-if="editGameData.provider === 'AppsFlyer'">
                            <label class="text-xs text-gray-500 mb-1 block">Dev Key</label>
                            <input v-model="editGameData.config_dev_key" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none font-mono">
                        </div>

                        <div v-if="editGameData.provider === 'Adjust'">
                            <label class="text-xs text-gray-500 mb-1 block">Environment</label>
                            <select v-model="editGameData.config_environment" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                                <option value="production">Production</option>
                                <option value="sandbox">Sandbox</option>
                            </select>
                        </div>

                        <div v-if="editGameData.provider === 'Singular'">
                            <label class="text-xs text-gray-500 mb-1 block">API Key</label>
                            <input v-model="editGameData.config_api_key" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none font-mono">
                        </div>
                    </div>

                    <!-- Events Mapping -->
                    <div class="space-y-3 p-4 bg-nexus-900/50 rounded-lg border border-nexus-800">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider">Event Tokens / Mapping</h4>
                            <button @click="addEventRow" class="text-xs bg-nexus-700 hover:bg-nexus-600 px-2 py-1 rounded text-white">+ Add Event</button>
                        </div>
                        
                        <div v-if="editGameData.config_events.length === 0" class="text-center text-xs text-gray-500 py-2">
                            No events mapped. Add one to start.
                        </div>

                        <div v-for="(evt, idx) in editGameData.config_events" :key="idx" class="flex gap-2 mb-2">
                            <input v-model="evt.name" placeholder="Event Name" class="flex-1 bg-nexus-900 border border-nexus-700 rounded px-2 py-1 text-white text-xs outline-none">
                            <input v-model="evt.token" placeholder="Token / Value" class="flex-1 bg-nexus-900 border border-nexus-700 rounded px-2 py-1 text-white text-xs outline-none font-mono">
                            <button @click="removeEventRow(idx)" class="text-red-400 hover:text-red-300 px-1"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                        </div>
                    </div>

                    <div class="space-y-3 p-4 bg-nexus-900/50 rounded-lg border border-nexus-800">
                        <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider">JSON Configuration (Advanced)</h4>
                        <textarea v-model="editGameData.json_configuration" rows="8" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-xs font-mono focus:border-nexus-500 outline-none resize-none"></textarea>
                    </div>

                    <div class="flex gap-3 justify-end mt-4">
                        <button v-if="(currentUser?.role === 'admin' || currentUser?.user_id === editGameData.owner_id) && editGameData.owner_id" @click="promoteGame(editGameData.id)" class="bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded text-sm font-bold shadow-lg shadow-purple-500/20 mr-auto flex items-center gap-2">
                            <i data-lucide="upload-cloud" class="w-4 h-4"></i> {{ t('promote') }}
                        </button>
                        <button @click="showEditGameModal = false" class="text-gray-400 hover:text-white text-sm">{{ t('cancel') }}</button>
                        <button @click="updateGame" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold shadow-lg shadow-blue-500/20">{{ t('save') }}</button>
                    </div>
                </div>
            </div>

            <!-- Add Balance Modal -->
            <div v-if="showBalanceModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
                <div class="glass w-full max-w-sm rounded-xl border border-nexus-700 p-6 space-y-4">
                    <h3 class="text-xl font-bold text-white">{{ t('add_balance') }}</h3>
                    <p class="text-sm text-gray-400">{{ t('user_id') }}: {{ selectedUser?.id }}</p>
                    <input v-model="balanceForm.amount" type="number" :placeholder="t('amount') + ' ($)'" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white">
                    <div class="flex gap-3 justify-end mt-4">
                        <button @click="showBalanceModal = false" class="text-gray-400 hover:text-white">{{ t('cancel') }}</button>
                        <button @click="addBalance" class="bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded">{{ t('add') }}</button>
                    </div>
                </div>
            </div>

            <!-- Change Password Modal -->
            <div v-if="showChangePasswordModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
                <div class="glass w-full max-w-md rounded-xl border border-nexus-700 p-6 space-y-4">
                    <h3 class="text-xl font-bold text-white">{{ t('change_password') }}</h3>
                    
                    <div class="space-y-3">
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">{{ t('current_password') }}</label>
                            <input v-model="passwordForm.current_password" type="password" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">{{ t('new_password') }}</label>
                            <input v-model="passwordForm.new_password" type="password" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-400 mb-1">{{ t('confirm_password') }}</label>
                            <input v-model="passwordForm.confirm_password" type="password" class="w-full bg-nexus-900 border border-nexus-700 rounded px-3 py-2 text-white text-sm focus:border-nexus-500 outline-none">
                        </div>
                    </div>

                    <div class="flex gap-3 justify-end mt-4">
                        <button @click="showChangePasswordModal = false" class="text-gray-400 hover:text-white text-sm">{{ t('cancel') }}</button>
                        <button @click="changePassword" class="bg-nexus-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold shadow-lg shadow-blue-500/20">{{ t('save') }}</button>
                    </div>
                </div>
            </div>

            <!-- Login Modal -->
            <div v-if="showLoginModal" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/90 backdrop-blur-md p-4">
                <div class="glass w-full max-w-md rounded-2xl border border-nexus-700 p-8 space-y-6 shadow-2xl shadow-blue-900/20">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-nexus-500 rounded-2xl mx-auto flex items-center justify-center mb-4 shadow-lg shadow-blue-500/30">
                            <i data-lucide="shield-check" class="w-8 h-8 text-white"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-white">{{ t('login_title') }}</h2>
                        <p class="text-gray-400 mt-2">{{ t('login_subtitle') }}</p>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-1">{{ t('username') }}</label>
                            <div class="relative">
                                <input v-model="loginForm.username" @keyup.enter="login" type="text" required class="w-full bg-nexus-900/50 border border-nexus-700 rounded-lg pl-10 pr-4 py-3 text-white focus:ring-2 focus:ring-nexus-500 focus:border-transparent transition-all">
                                <i data-lucide="user" class="absolute left-3 top-3.5 text-gray-500 w-5 h-5"></i>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-1">{{ t('password') }}</label>
                            <div class="relative">
                                <input v-model="loginForm.password" @keyup.enter="login" type="password" required class="w-full bg-nexus-900/50 border border-nexus-700 rounded-lg pl-10 pr-4 py-3 text-white focus:ring-2 focus:ring-nexus-500 focus:border-transparent transition-all">
                                <i data-lucide="lock" class="absolute left-3 top-3.5 text-gray-500 w-5 h-5"></i>
                            </div>
                        </div>

                        <div v-if="loginError" class="text-red-400 text-sm text-center bg-red-500/10 py-2 rounded-lg border border-red-500/20">
                            {{ loginError }}
                        </div>

                        <button type="button" @click="login" class="w-full bg-nexus-500 hover:bg-blue-600 text-white font-bold py-3 rounded-lg shadow-lg shadow-blue-500/20 transition-all transform hover:scale-[1.02]">
                            {{ t('login_btn') }} (Local)
                        </button>
                    </div>
                </div>
            </div>

            <!-- Toast Notification -->
            <div v-if="showToast" class="fixed bottom-4 right-4 bg-nexus-500 text-white px-4 py-2 rounded-lg shadow-lg animate-bounce z-50">
                {{ toastMsg }}
            </div>

        </main>
    </div>

    <script>
        const { createApp, ref, onMounted, nextTick } = Vue;

        createApp({
            setup() {
                const { ref, onMounted, nextTick, computed } = Vue;
                
                // Auth & Lang State
                const currentLang = ref(localStorage.getItem('lang') || 'en');
                const currentUser = ref(null);
                const token = ref(localStorage.getItem('token') || '');
                const showLoginModal = ref(false);
                const showChangePasswordModal = ref(false);
                const loginForm = ref({ username: '', password: '' });
                const passwordForm = ref({ current_password: '', new_password: '', confirm_password: '' });
                const loginError = ref('');
                const showAddBalanceAllModal = ref(false);
                const addBalanceAllAmount = ref(0);
                const showEditResendModal = ref(false);
                const resendBody = ref('');

                const translations = {
                    en: {
                        dashboard: "Dashboard",
                        games: "Games Manager",
                        users: "Users",
                        logs: "Live Logs",
                        chat: "Chat",
                        admin: "Admin Panel",
                        system_online: "System Online",
                        command_center: "Command Center",
                        real_time_overview: "Real-time system overview",
                        total_users: "Total Users",
                        active_games: "Active Games",
                        events_24h: "Events (24h)",
                        system_load: "System Load",
                        recent_activity: "Recent S2S Activity",
                        time: "Time",
                        game: "Game",
                        event: "Event",
                        status: "Status",
                        archive: "Archive",
                        platform: "Platform",
                        device_os: "Device OS",
                        search: "Search...",
                        apply: "Apply",
                        reset: "Reset",
                        refresh: "Refresh",
                        chat_desc: "Admin support inbox and user messages",
                        conversations: "Conversations",
                        no_conversations: "No conversations yet.",
                        select_conversation: "Select a conversation",
                        select_conversation_hint: "Select a conversation to view messages.",
                        no_messages: "No messages.",
                        type_message: "Type a message...",
                        send: "Send",
                        no_results: "No results.",
                        total: "Total",
                        prev: "Prev",
                        next: "Next",
                        add_game: "Add Game",
                        search_users: "Search users...",
                        user_id: "User ID",
                        balance: "Balance",
                        last_active: "Last Active",
                        actions: "Actions",
                        system_controls: "System Controls",
                        backup_now: "Backup Now",
                        price_per_point: "Price Per Point",
                        quick_balance: "Quick Balance Add",
                        management: "Management",
                        platform_config: "Platform Configuration",
                        save_settings: "Save Settings",
                        login: "Login",
                        logout: "Logout",
                        username: "Username",
                        password: "Password",
                        login_title: "Access Restricted",
                        login_subtitle: "Please log in to continue",
                        login_btn: "Sign In",
                        banned: "Banned",
                        active: "Active",
                        disabled: "Disabled",
                        server_api: "Server API",
                        client_sdk: "Client SDK",
                        change_password: "Change Password",
                        current_password: "Current Password",
                        new_password: "New Password",
                        confirm_password: "Confirm Password",
                        passwords_no_match: "Passwords do not match",
                        password_changed: "Password changed successfully",
                        error_changing_password: "Error changing password",
                        provider_config: "Configuration",
                        main_key: "Main Key",
                        advanced_data: "Advanced Data",
                        app_token: "App Token",
                        api_key: "API Key",
                        dev_key: "Dev Key",
                        level_sequence: "Level Sequence (Lvl:Token)",
                        secret_config: "Secret / Config",
                        event_template: "Event Template / Default",
                        validation_adjust_len: "Adjust App Token must be 12 alphanumeric characters",
                        validation_appsflyer_len: "AppsFlyer Dev Key must be at least 5 characters",
                        validation_singular_len: "Singular API Key must be at least 20 characters",
                        validation_required: "All fields are required",
                        save: "Save",
                        cancel: "Cancel",
                        add_new_game: "Add New Game",
                        game_name: "Game Name",
                        package_name: "Package Name",
                        provider: "Provider",
                        format_adjust: "Format: Level:Token (one per line)",
                        format_singular: "Additional configuration details",
                        format_appsflyer: "Use 'default' for standard template",
                        add_balance: "Add Balance",
                        amount: "Amount",
                        add: "Add",
                        edit_game: "Edit Game",
                        delete_game_confirm: "Are you sure you want to delete this game?",
                        game_updated: "Game updated successfully",
                        error_updating_game: "Error updating game",
                        game_deleted: "Game deleted successfully",
                        error_deleting_game: "Error deleting game",
                        add_balance_all: "Add Balance to All",
                        add_balance_all_confirm: "Are you sure you want to add balance to ALL users? This action cannot be undone.",
                        confirm: "Confirm",
                        balance_added_success: "Balance added to all users successfully",
                        scope: "Scope",
                        global: "Global",
                        private: "Private",
                        promote: "Promote to Global",
                        promote_confirm: "Are you sure you want to promote this game to Global? It will be visible to all users.",
                        promote_success: "Game promoted successfully",
                        all: "All",
                        platform_stats_title: "Platform Success Overview",
                        platform_events: "Events",
                        platform_success: "Success",
                        platform_success_rate: "Success Rate",
                        finance: "Finance",
                        finance_management: "Finance Management",
                        stats: "Stats",
                        transactions: "Transactions",
                        coupons: "Coupons",
                        wallet_reset: "Wallet Reset"
                    },
                    ar: {
                        dashboard: "ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ",
                        games: "ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ®",
                        users: "ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ",
                        logs: "ÿßŸÑÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ≠Ÿäÿ©",
                        chat: "ÿßŸÑÿØÿ±ÿØÿ¥ÿ©",
                        admin: "ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖÿØŸäÿ±",
                        system_online: "ÿßŸÑŸÜÿ∏ÿßŸÖ ŸÖÿ™ÿµŸÑ",
                        command_center: "ŸÖÿ±ŸÉÿ≤ ÿßŸÑŸÇŸäÿßÿØÿ©",
                        real_time_overview: "ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ© ŸÑÿ≠ÿ∏Ÿäÿ© ŸÑŸÑŸÜÿ∏ÿßŸÖ",
                        total_users: "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ",
                        active_games: "ÿßŸÑÿ£ŸÑÿπÿßÿ® ÿßŸÑŸÜÿ¥ÿ∑ÿ©",
                        events_24h: "ÿ£ÿ≠ÿØÿßÿ´ (24 ÿ≥ÿßÿπÿ©)",
                        system_load: "ÿ≠ŸÖŸÑ ÿßŸÑŸÜÿ∏ÿßŸÖ",
                        recent_activity: "ŸÜÿ¥ÿßÿ∑ S2S ÿßŸÑÿ≠ÿØŸäÿ´",
                        time: "ÿßŸÑŸàŸÇÿ™",
                        game: "ÿßŸÑŸÑÿπÿ®ÿ©",
                        event: "ÿßŸÑÿ≠ÿØÿ´",
                        status: "ÿßŸÑÿ≠ÿßŸÑÿ©",
                        archive: "ÿßŸÑÿ£ÿ±ÿ¥ŸäŸÅ",
                        platform: "ÿßŸÑŸÖŸÜÿµÿ©",
                        device_os: "ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ¨Ÿáÿßÿ≤",
                        search: "ÿ®ÿ≠ÿ´...",
                        apply: "ÿ™ÿ∑ÿ®ŸäŸÇ",
                        reset: "ÿ•ÿπÿßÿØÿ© ÿ∂ÿ®ÿ∑",
                        refresh: "ÿ™ÿ≠ÿØŸäÿ´",
                        chat_desc: "ÿµŸÜÿØŸàŸÇ ÿØÿπŸÖ ÿßŸÑÿ•ÿØÿßÿ±ÿ© Ÿàÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ",
                        conversations: "ÿßŸÑŸÖÿ≠ÿßÿØÿ´ÿßÿ™",
                        no_conversations: "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ≠ÿßÿØÿ´ÿßÿ™ ÿ®ÿπÿØ.",
                        select_conversation: "ÿßÿÆÿ™ÿ± ŸÖÿ≠ÿßÿØÿ´ÿ©",
                        select_conversation_hint: "ÿßÿÆÿ™ÿ± ŸÖÿ≠ÿßÿØÿ´ÿ© ŸÑÿπÿ±ÿ∂ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ.",
                        no_messages: "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ±ÿ≥ÿßÿ¶ŸÑ.",
                        type_message: "ÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ©...",
                        send: "ÿ•ÿ±ÿ≥ÿßŸÑ",
                        no_results: "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÜÿ™ÿßÿ¶ÿ¨",
                        total: "ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä",
                        prev: "ÿßŸÑÿ≥ÿßÿ®ŸÇ",
                        next: "ÿßŸÑÿ™ÿßŸÑŸä",
                        add_game: "ÿ•ÿ∂ÿßŸÅÿ© ŸÑÿπÿ®ÿ©",
                        search_users: "ÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖÿ≥ÿ™ÿÆÿØŸÖ...",
                        user_id: "ŸÖÿπÿ±ŸÅ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ",
                        balance: "ÿßŸÑÿ±ÿµŸäÿØ",
                        last_active: "ÿ¢ÿÆÿ± ŸÜÿ¥ÿßÿ∑",
                        actions: "ÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™",
                        system_controls: "ÿ™ÿ≠ŸÉŸÖ ÿßŸÑŸÜÿ∏ÿßŸÖ",
                        backup_now: "ŸÜÿ≥ÿÆ ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä ÿßŸÑÿ¢ŸÜ",
                        price_per_point: "ÿ≥ÿπÿ± ÿßŸÑŸÜŸÇÿ∑ÿ©",
                        quick_balance: "ÿ¥ÿ≠ŸÜ ÿ±ÿµŸäÿØ ÿ≥ÿ±Ÿäÿπ",
                        management: "ÿ•ÿØÿßÿ±ÿ©",
                        platform_config: "ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖŸÜÿµÿßÿ™",
                        save_settings: "ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™",
                        login: "ÿØÿÆŸàŸÑ",
                        logout: "ÿÆÿ±Ÿàÿ¨",
                        username: "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ",
                        password: "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
                        login_title: "ÿßŸÑÿØÿÆŸàŸÑ ŸÖŸÇŸäÿØ",
                        login_subtitle: "ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ŸÑŸÑŸÖÿ™ÿßÿ®ÿπÿ©",
                        login_btn: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
                        banned: "ŸÖÿ≠ÿ∏Ÿàÿ±",
                        active: "ŸÜÿ¥ÿ∑",
                        disabled: "ŸÖÿπÿ∑ŸÑ",
                        server_api: "Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑÿÆÿßÿØŸÖ (API)",
                        client_sdk: "ÿ≠ÿ≤ŸÖÿ© ÿßŸÑÿπŸÖŸäŸÑ (SDK)",
                        change_password: "ÿ™ÿ∫ŸäŸäÿ± ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
                        current_password: "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ≠ÿßŸÑŸäÿ©",
                        new_password: "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ©",
                        confirm_password: "ÿ™ÿ£ŸÉŸäÿØ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
                        passwords_no_match: "ŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ©",
                        password_changed: "ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿ®ŸÜÿ¨ÿßÿ≠",
                        error_changing_password: "ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ∫ŸäŸäÿ± ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
                        provider_config: "ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™",
                        main_key: "ÿßŸÑŸÖŸÅÿ™ÿßÿ≠ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä",
                        advanced_data: "ÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ™ŸÇÿØŸÖÿ©",
                        app_token: "ÿ±ŸÖÿ≤ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ (App Token)",
                        api_key: "ŸÖŸÅÿ™ÿßÿ≠ API",
                        dev_key: "ŸÖŸÅÿ™ÿßÿ≠ ÿßŸÑŸÖÿ∑Ÿàÿ± (Dev Key)",
                        level_sequence: "ÿ™ÿ≥ŸÑÿ≥ŸÑ ÿßŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™ (ŸÖÿ≥ÿ™ŸàŸâ:ÿ±ŸÖÿ≤)",
                        secret_config: "ÿßŸÑÿ≥ÿ± / ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™",
                        event_template: "ŸÇÿßŸÑÿ® ÿßŸÑÿ≠ÿØÿ´ / ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä",
                        validation_adjust_len: "ÿ±ŸÖÿ≤ Adjust Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ 12 ÿ≠ÿ±ŸÅÿßŸã Ÿàÿ£ÿ±ŸÇÿßŸÖÿßŸã",
                        validation_appsflyer_len: "ŸÖŸÅÿ™ÿßÿ≠ AppsFlyer Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ 5 ÿ£ÿ≠ÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ",
                        validation_singular_len: "ŸÖŸÅÿ™ÿßÿ≠ Singular Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ 20 ÿ≠ÿ±ŸÅÿßŸã ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ",
                        validation_required: "ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ ŸÖÿ∑ŸÑŸàÿ®ÿ©",
                        save: "ÿ≠ŸÅÿ∏",
                        cancel: "ÿ•ŸÑÿ∫ÿßÿ°",
                        add_new_game: "ÿ•ÿ∂ÿßŸÅÿ© ŸÑÿπÿ®ÿ© ÿ¨ÿØŸäÿØÿ©",
                        game_name: "ÿßÿ≥ŸÖ ÿßŸÑŸÑÿπÿ®ÿ©",
                        package_name: "ÿßÿ≥ŸÖ ÿßŸÑÿ≠ÿ≤ŸÖÿ©",
                        provider: "ÿßŸÑŸÖÿ≤ŸàÿØ",
                        format_adjust: "ÿßŸÑÿ™ŸÜÿ≥ŸäŸÇ: ŸÖÿ≥ÿ™ŸàŸâ:ÿ±ŸÖÿ≤ (Ÿàÿßÿ≠ÿØ ŸÅŸä ŸÉŸÑ ÿ≥ÿ∑ÿ±)",
                        format_singular: "ÿ™ŸÅÿßÿµŸäŸÑ ÿ•ÿπÿØÿßÿØ ÿ•ÿ∂ÿßŸÅŸäÿ©",
                        format_appsflyer: "ÿßÿ≥ÿ™ÿÆÿØŸÖ 'default' ŸÑŸÑŸÇÿßŸÑÿ® ÿßŸÑŸÇŸäÿßÿ≥Ÿä",
                        add_balance: "ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿµŸäÿØ",
                        amount: "ÿßŸÑŸÉŸÖŸäÿ©",
                        add: "ÿ•ÿ∂ÿßŸÅÿ©",
                        edit_game: "ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÑÿπÿ®ÿ©",
                        delete_game_confirm: "ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ≠ÿ∞ŸÅ Ÿáÿ∞Ÿá ÿßŸÑŸÑÿπÿ®ÿ©ÿü",
                        game_updated: "ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÑÿπÿ®ÿ© ÿ®ŸÜÿ¨ÿßÿ≠",
                        error_updating_game: "ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÑÿπÿ®ÿ©",
                        game_deleted: "ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÑÿπÿ®ÿ© ÿ®ŸÜÿ¨ÿßÿ≠",
                        error_deleting_game: "ÿÆÿ∑ÿ£ ŸÅŸä ÿ≠ÿ∞ŸÅ ÿßŸÑŸÑÿπÿ®ÿ©",
                        bot_management: "ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ®Ÿàÿ™ÿßÿ™",
                        tokens: "ÿßŸÑÿ™ŸàŸÉŸÜÿßÿ™",
                        access_control: "ÿµŸÑÿßÿ≠Ÿäÿßÿ™ ÿßŸÑŸàÿµŸàŸÑ",
                        add_token: "ÿ•ÿ∂ÿßŸÅÿ© ÿ™ŸàŸÉŸÜ",
                        token_name: "ÿßÿ≥ŸÖ ÿßŸÑÿ™ŸàŸÉŸÜ",
                        token_value: "ŸÇŸäŸÖÿ© ÿßŸÑÿ™ŸàŸÉŸÜ",
                        add_user: "ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ",
                        role: "ÿßŸÑÿØŸàÿ±",
                        editor: "ŸÖÿ≠ÿ±ÿ±",
                        delete_token_confirm: "ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑÿ™ŸàŸÉŸÜÿü",
                        delete_access_confirm: "ÿ•ÿ≤ÿßŸÑÿ© ÿµŸÑÿßÿ≠Ÿäÿßÿ™ Ÿáÿ∞ÿß ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖÿü",
                        token_added: "ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ŸàŸÉŸÜ ÿ®ŸÜÿ¨ÿßÿ≠",
                        access_added: "ÿ™ŸÖ ŸÖŸÜÿ≠ ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠",
                        token_deleted: "ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑÿ™ŸàŸÉŸÜ",
                        access_deleted: "ÿ™ŸÖ ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™",
                        error_adding_token: "ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ŸàŸÉŸÜ",
                        error_adding_access: "ÿÆÿ∑ÿ£ ŸÅŸä ŸÖŸÜÿ≠ ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™",
                        copy_id: "ŸÜÿ≥ÿÆ ÿßŸÑŸÖÿπÿ±ŸÅ",
                        add_balance_all: "ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿµŸäÿØ ŸÑŸÑÿ¨ŸÖŸäÿπ",
                        add_balance_all_confirm: "ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿµŸäÿØ ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜÿü ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°.",
                        confirm: "ÿ™ÿ£ŸÉŸäÿØ",
                        balance_added_success: "ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ±ÿµŸäÿØ ŸÑŸÑÿ¨ŸÖŸäÿπ ÿ®ŸÜÿ¨ÿßÿ≠",
                        scope: "ÿßŸÑŸÜÿ∑ÿßŸÇ",
                        global: "ÿπÿßŸÖ",
                        private: "ÿÆÿßÿµ",
                        promote: "ÿ™ÿ±ŸÇŸäÿ© ŸÑÿπÿßŸÖ",
                        promote_confirm: "ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ™ÿ±ŸÇŸäÿ© Ÿáÿ∞Ÿá ÿßŸÑŸÑÿπÿ®ÿ© ŸÑÿ™ÿµÿ®ÿ≠ ÿπÿßŸÖÿ©ÿü ÿ≥ÿ™ÿ∏Ÿáÿ± ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ.",
                        promote_success: "ÿ™ŸÖ ÿ™ÿ±ŸÇŸäÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿ®ŸÜÿ¨ÿßÿ≠",
                        all: "ÿßŸÑŸÉŸÑ",
                        platform_stats_title: "ŸÜÿ≥ÿ®ÿ© ÿßŸÑŸÜÿ¨ÿßÿ≠ ÿ≠ÿ≥ÿ® ÿßŸÑŸÖŸÜÿµÿ©",
                        platform_events: "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ£ÿ≠ÿØÿßÿ´",
                        platform_success: "ÿßŸÑÿπŸÖŸÑŸäÿßÿ™ ÿßŸÑŸÜÿßÿ¨ÿ≠ÿ©",
                        platform_success_rate: "ŸÜÿ≥ÿ®ÿ© ÿßŸÑŸÜÿ¨ÿßÿ≠",
                        finance: "ÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿßŸÑŸäÿ©",
                        finance_management: "ÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿßŸÑŸäÿ©",
                        stats: "ÿßŸÑÿ•ÿ≠ÿµÿßÿ°ÿßÿ™",
                        transactions: "ÿßŸÑÿ™ÿπÿßŸÖŸÑÿßÿ™",
                        coupons: "ÿßŸÑŸÉŸàÿ®ŸàŸÜÿßÿ™",
                        wallet_reset: "ÿ™ÿµŸÅŸäÿ± ÿßŸÑŸÖÿ≠ÿßŸÅÿ∏"
                    }
                };

                const t = (key) => {
                    return translations[currentLang.value][key] || key;
                };

                const setLang = (lang) => {
                    currentLang.value = lang;
                    localStorage.setItem('lang', lang);
                    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
                };

                // --- Auth Functions ---
                const authFetch = async (url, options = {}) => {
                    if (!options.headers) options.headers = {};
                    if (token.value) {
                        options.headers['Authorization'] = `Bearer ${token.value}`;
                    }
                    const res = await fetch(url, options);
                    if (res.status === 401) {
                        logout();
                        throw new Error("Unauthorized");
                    }
                    return res;
                };

                const login = async () => {
                    try {
                        const res = await fetch('/api/auth/login', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(loginForm.value)
                        });
                        if (res.ok) {
                            const data = await res.json();
                            token.value = data.token;
                            currentUser.value = data.user;
                            localStorage.setItem('token', data.token);
                            showLoginModal.value = false;
                            initData(); 
                        } else {
                            loginError.value = "Invalid credentials";
                        }
                    } catch (e) {
                        loginError.value = "Login error";
                    }
                };

                const logout = () => {
                    token.value = '';
                    currentUser.value = null;
                    localStorage.removeItem('token');
                    showLoginModal.value = true;
                };

                const checkAuth = async () => {
                    if (!token.value) {
                        showLoginModal.value = true;
                        return;
                    }
                    try {
                        const res = await fetch('/api/auth/me', {
                            headers: { 'Authorization': `Bearer ${token.value}` }
                        });
                        if (res.ok) {
                            currentUser.value = await res.json();
                            initData();
                        } else {
                            logout();
                        }
                    } catch (e) { logout(); }
                };

                const currentTab = ref('dashboard');
                const sidebarOpen = ref(false);
                const stats = ref({});
                const games = ref([]);
                const filterScope = ref('all');
                const users = ref([]);
                const history = ref([]);
                const archiveItems = ref([]);
                const archiveTotal = ref(0);
                const archiveOffset = ref(0);
                const archiveLimit = ref(50);
                const archiveFilters = ref({
                    q: '',
                    user_id: '',
                    game: '',
                    platform: '',
                    event: '',
                    status_code: '',
                    from_ts: '',
                    to_ts: ''
                });
                const timelines = ref([]);
                const liveLogs = ref([]);
                const chatConversations = ref([]);
                const chatSelectedConversation = ref(null);
                const chatMessages = ref([]);
                const chatNewMessage = ref('');
                const changelogs = ref([]);
                const platformSettings = ref({
                    adjust_server: true, adjust_client: true,
                    appsflyer_server: true, appsflyer_client: true,
                    singular_server: true, singular_client: true
                });
                const globalProxiesText = ref('');
                const networkStatus = ref({ direct_ip: null, proxies: [] });
                let socket = null;

                const detailsModal = ref(false);
                const showAddGameModal = ref(false);
                const showEditGameModal = ref(false);
                const showBalanceModal = ref(false);
                const selectedLog = ref(null);
                const selectedUser = ref(null);
                const detailTab = ref('summary');
                const rawView = ref(false);
                const headerSearch = ref('');
                const toastMsg = ref('');
                const showToast = ref(false);
                const loading = ref(false);

                // Bot Management State
                const botTokens = ref([]);
                const botAccessList = ref([]);
                const showAddTokenModal = ref(false);
                const showAddAccessModal = ref(false);
                const newToken = ref({ name: '', token: '' });
                const newAccess = ref({ user_id: '', role: 'editor', name: '' });

                const storeTab = ref('items');
                const storeChannelsText = ref('');
                const storeChannelsCurrent = ref([]);
                const storeChannelsLog = ref([]);
                const storeCategories = ref([]);
                const storeNewCategory = ref({ name: '', slug: '', sort_order: 0 });
                const storeItemsStatus = ref('unpublished');
                const storeItemsQuery = ref('');
                const storeItemsTotal = ref(0);
                const storeItems = ref([]);
                const showStoreItemEditor = ref(false);
                const storeItemEdit = ref(null);
                const storeItemEditTargetId = ref(null);
                const storeItemPreviewUrl = ref('');
                const storeItemPreviewLoading = ref(false);
                const storePurchasesFilters = ref({ user_id: '', item_id: '' });
                const storePurchasesTotal = ref(0);
                const storePurchases = ref([]);

                // Forms
                const newGame = ref({ name: '', package_name: '', provider: 'AppsFlyer', device_os: 'android', main_key: '', advanced_data: '', price: 0 });
                const editGameData = ref({ id: null, name: '', package_name: '', provider: '', json_configuration: '', is_active: true, price: 0 });
                const balanceForm = ref({ amount: 0 });
                const couponForm = ref({ amount: 0, uses: 1 });
                const timelineForm = ref({ hours: 0 });
                const priceForm = ref({ amount: 0 });
                const broadcastMsg = ref('');
                const manualBalanceForm = ref({ user_id: '', amount: '' });

                const triggerToast = (msg) => {
                    toastMsg.value = msg;
                    showToast.value = true;
                    setTimeout(() => showToast.value = false, 2000);
                };

                const fetchStats = async () => {
                    try {
                        const res = await authFetch('/api/stats');
                        if (res.ok) {
                            stats.value = await res.json();
                        } else {
                            console.error('Failed to fetch stats');
                            stats.value = { users: 0, games: { total: 0, active: 0 }, events: { total: 0, last_24h: 0 }, platforms: {} };
                        }
                        
                        const histRes = await authFetch('/api/history?limit=10');
                        const histData = await histRes.json();
                        history.value = Array.isArray(histData) ? histData : [];
                    } catch (e) { 
                        console.error(e); 
                        stats.value = { users: 0, games: { total: 0, active: 0 }, events: { total: 0, last_24h: 0 }, platforms: {} };
                        history.value = [];
                    }
                };

                const fetchPlatformSettings = async () => {
                    try {
                        const res = await authFetch('/api/settings/platforms');
                        const data = await res.json();
                        platformSettings.value = data || {};
                    } catch(e) { console.error(e); }
                };

                const savePlatformSettings = async () => {
                    try {
                        await authFetch('/api/settings/platforms', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(platformSettings.value)
                        });
                        triggerToast('Settings saved successfully!');
                        fetchChangelogs(); // Refresh logs
                    } catch(e) { triggerToast('Error saving settings'); }
                };

                const fetchGlobalProxies = async () => {
                    try {
                        const res = await authFetch('/api/network/proxies');
                        const data = await res.json();
                        const proxies = Array.isArray(data?.proxies) ? data.proxies : [];
                        globalProxiesText.value = proxies.join('\n');
                    } catch (e) {
                        console.error(e);
                        globalProxiesText.value = '';
                    }
                };

                const saveGlobalProxies = async () => {
                    try {
                        const lines = (globalProxiesText.value || '').split('\n').map(s => s.trim()).filter(Boolean);
                        await authFetch('/api/network/proxies', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ proxies: lines })
                        });
                        triggerToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™');
                        fetchNetworkStatus();
                        fetchChangelogs();
                    } catch (e) {
                        triggerToast('ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™');
                    }
                };

                const importProxies = async (source) => {
                    const replace = confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿßÿ≥ÿ™ÿ®ÿØÿßŸÑ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©ÿü\nOK = ÿßÿ≥ÿ™ÿ®ÿØÿßŸÑ\nCancel = ÿ•ÿ∂ÿßŸÅÿ© ŸÑŸÑŸÇÿßÿ¶ŸÖÿ©');
                    const mode = replace ? 'replace' : 'append';
                    try {
                        const res = await authFetch('/api/network/proxies/import', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ source, mode, limit: 200 })
                        });
                        let data = null;
                        try { data = await res.json(); } catch (e) { data = null; }
                        if (!res.ok) {
                            if (res.status === 404) {
                                triggerToast('ŸÖŸäÿ≤ÿ© ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿ∫Ÿäÿ± ŸÖŸÅÿπŸëŸÑÿ© ÿπŸÑŸâ ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ± ÿßŸÑÿ≠ÿßŸÑŸä (ÿ£ÿπÿØ ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿÆÿßÿØŸÖ)');
                                return;
                            }
                            const msg = data?.detail || `ŸÅÿ¥ŸÑ ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ (${res.status})`;
                            triggerToast(msg);
                            return;
                        }
                        const added = data.added_active || 0;
                        const tested = data.total_tested || 0;
                        const failed = data.failed || 0;
                        triggerToast(`ÿ™ŸÖ ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ${added} ÿ®ÿ±ŸàŸÉÿ≥Ÿä ŸÜÿ¥ÿ∑ (ÿ™ŸÖ ŸÅÿ≠ÿµ ${tested} / ŸÅÿ¥ŸÑ ${failed})`);
                        await fetchGlobalProxies();
                        await fetchNetworkStatus();
                        await fetchChangelogs();
                    } catch (e) {
                        triggerToast('ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ®ÿ±ŸàŸÉÿ≥Ÿäÿßÿ™');
                    }
                };

                const fetchNetworkStatus = async () => {
                    try {
                        const res = await authFetch('/api/network/status');
                        const data = await res.json();
                        networkStatus.value = data || { direct_ip: null, proxies: [] };
                    } catch (e) {
                        console.error(e);
                        networkStatus.value = { direct_ip: null, proxies: [] };
                    }
                };

                const fetchStoreChannels = async () => {
                    try {
                        const res = await authFetch('/api/admin/store/channels');
                        const data = await res.json();
                        const ids = Array.isArray(data?.channels) ? data.channels : (Array.isArray(data?.channel_ids) ? data.channel_ids : []);
                        storeChannelsCurrent.value = ids;
                        storeChannelsText.value = ids.map(x => String(x)).join('\n');
                    } catch (e) {
                        console.error(e);
                    }
                };

                const fetchStoreChannelsLog = async () => {
                    try {
                        const res = await authFetch('/api/admin/store/channels/log?limit=50');
                        const data = await res.json();
                        storeChannelsLog.value = Array.isArray(data) ? data : [];
                    } catch (e) {
                        console.error(e);
                        storeChannelsLog.value = [];
                    }
                };

                const saveStoreChannels = async () => {
                    try {
                        // ÿ™ÿ≠ŸÑŸäŸÑ ŸÉŸÑ ÿ≥ÿ∑ÿ±: ÿ±ÿßÿ®ÿ∑ ÿØÿπŸàÿ©ÿå @ŸäŸàÿ≤ÿ±ÿå ÿ£Ÿà ID ÿ±ŸÇŸÖŸä
                        const lines = (storeChannelsText.value || '').split('\n').map(s => s.trim()).filter(Boolean);
                        const resolved = [];
                        for (const raw of lines) {
                            let id = null;
                            if (/^-?\d+$/.test(raw)) {
                                id = parseInt(raw, 10);
                            } else if (raw.startsWith('@')) {
                                const u = raw.slice(1);
                                const r = await authFetch(`/api/admin/store/resolve?username=${encodeURIComponent(u)}`);
                                if (r.ok) {
                                    const d = await r.json();
                                    id = d.id;
                                } else {
                                    triggerToast(`ŸÑŸÖ ŸäŸèÿ≠ŸÑŸÑ ${raw}`);
                                    continue;
                                }
                            } else if (/^[A-Za-z0-9_]{5,}$/.test(raw)) {
                                const r = await authFetch(`/api/admin/store/resolve?username=${encodeURIComponent(raw)}`);
                                if (r.ok) {
                                    const d = await r.json();
                                    id = d.id;
                                } else {
                                    triggerToast(`ŸÑŸÖ ŸäŸèÿ≠ŸÑŸÑ ${raw}`);
                                    continue;
                                }
                            } else if (raw.includes('t.me/')) {
                                // ÿ±ÿßÿ®ÿ∑ ÿØÿπŸàÿ© ÿ£Ÿà ŸäŸàÿ≤ÿ±
                                const r = await authFetch(`/api/admin/store/resolve?link=${encodeURIComponent(raw)}`);
                                if (r.ok) {
                                    const d = await r.json();
                                    id = d.id;
                                } else {
                                    triggerToast(`ŸÑŸÖ ŸäŸèÿ≠ŸÑŸÑ ${raw}`);
                                    continue;
                                }
                            }
                            if (id && id !== 0) resolved.push(id);
                        }
                        const unique = Array.from(new Set(resolved));
                        const res = await authFetch('/api/admin/store/channels', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ channels: unique })
                        });
                        if (res.ok) {
                            triggerToast(`ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑŸÇŸÜŸàÿßÿ™: ${unique.join(', ')}`);
                            await fetchStoreChannels();
                            await fetchStoreChannelsLog();
                        } else {
                            const err = await res.json();
                            triggerToast(err?.detail || 'ŸÅÿ¥ŸÑ ÿßŸÑÿ≠ŸÅÿ∏');
                        }
                    } catch (e) {
                        triggerToast('ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ≠ŸÅÿ∏');
                    }
                };

                const scanStoreChannels = async () => {
                    try {
                        triggerToast('ÿ¨ÿßÿ±Ÿä ŸÅÿ≠ÿµ ÿßŸÑŸÇŸÜŸàÿßÿ™...');
                        const res = await authFetch('/api/admin/store/scan', { method: 'POST' });
                        const raw = await res.text();
                        let data = {};
                        try { data = raw ? JSON.parse(raw) : {}; } catch { data = { detail: raw }; }
                        if (res.ok) {
                            const ok = data.ok || 0;
                            const failed = data.failed || 0;
                            const botU = data?.bot?.username ? `@${data.bot.username}` : 'BOT';
                            if (failed > 0) {
                                triggerToast(`${botU}: ÿ™ŸÖ ÿßŸÑÿ±ÿ®ÿ∑ ${ok} ŸàŸÅÿ¥ŸÑ ${failed}`);
                            } else {
                                triggerToast(`${botU}: ÿ™ŸÖ ÿ±ÿ®ÿ∑ ${ok} ŸÇŸÜÿßÿ©`);
                            }
                        } else {
                            triggerToast(data.detail || `ŸÅÿ¥ŸÑ ÿßŸÑŸÅÿ≠ÿµ (${res.status})`);
                        }
                    } catch (e) {
                        triggerToast(`ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑŸÅÿ≠ÿµ: ${String(e)}`);
                    }
                };

                const testStoreIngest = async () => {
                    try {
                        triggerToast('ÿ¨ÿßÿ±Ÿä ÿ•ÿ±ÿ≥ÿßŸÑ ÿµŸàÿ±ÿ© ÿßÿÆÿ™ÿ®ÿßÿ±...');
                        const res = await authFetch('/api/admin/store/test', { method: 'POST' });
                        const raw = await res.text();
                        let data = {};
                        try { data = raw ? JSON.parse(raw) : {}; } catch { data = { detail: raw }; }
                        if (res.ok) {
                            const ok = data.ok || 0;
                            const botU = data?.bot?.username ? `@${data.bot.username}` : 'BOT';
                            triggerToast(`${botU}: ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßÿÆÿ™ÿ®ÿßÿ± ÿ•ŸÑŸâ ${ok} ŸÇŸÜÿßÿ©`);
                            await new Promise(r => setTimeout(r, 1200));
                            const dbgRes = await authFetch('/api/admin/store/items/debug');
                            const dbgRaw = await dbgRes.text();
                            let dbg = {};
                            try { dbg = dbgRaw ? JSON.parse(dbgRaw) : {}; } catch { dbg = { detail: dbgRaw }; }
                            if (dbgRes.ok) {
                                triggerToast(`StoreItems: ${dbg.total || 0}`);
                            } else {
                                triggerToast(dbg.detail || `ŸÅÿ¥ŸÑ debug (${dbgRes.status})`);
                            }
                            storeTab.value = 'items';
                            storeItemsStatus.value = 'unpublished';
                            storeItemsQuery.value = '';
                            await fetchStoreItems();
                        } else {
                            triggerToast(data.detail || `ŸÅÿ¥ŸÑ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ± (${res.status})`);
                        }
                    } catch (e) {
                        triggerToast(`ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±: ${String(e)}`);
                    }
                };

                const fetchStoreCategories = async () => {
                    try {
                        const res = await authFetch('/api/admin/store/categories');
                        const data = await res.json();
                        storeCategories.value = Array.isArray(data) ? data : [];
                    } catch (e) {
                        console.error(e);
                        storeCategories.value = [];
                    }
                };

                const createStoreCategory = async () => {
                    try {
                        const payload = {
                            name: (storeNewCategory.value.name || '').trim(),
                            slug: (storeNewCategory.value.slug || '').trim(),
                            sort_order: parseInt(storeNewCategory.value.sort_order || 0, 10) || 0,
                            is_active: true
                        };
                        if (!payload.name) return;
                        const res = await authFetch('/api/admin/store/categories', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        if (res.ok) {
                            storeNewCategory.value = { name: '', slug: '', sort_order: 0 };
                            triggerToast('ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÇÿ≥ŸÖ');
                            fetchStoreCategories();
                        } else {
                            const err = await res.json();
                            triggerToast(err?.detail || 'ŸÅÿ¥ŸÑ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÇÿ≥ŸÖ');
                        }
                    } catch (e) {
                        triggerToast('ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ•ÿ∂ÿßŸÅÿ©');
                    }
                };

                const toggleStoreCategory = async (cat) => {
                    try {
                        const res = await authFetch(`/api/admin/store/categories/${cat.id}`, {
                            method: 'PATCH',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ is_active: !cat.is_active })
                        });
                        if (res.ok) {
                            cat.is_active = !cat.is_active;
                            triggerToast('ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´');
                        } else {
                            const err = await res.json();
                            triggerToast(err?.detail || 'ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´');
                        }
                    } catch (e) {
                        triggerToast('ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ™ÿ≠ÿØŸäÿ´');
                    }
                };

                const fetchStoreItems = async () => {
                    try {
                        const qs = new URLSearchParams();
                        qs.set('status', storeItemsStatus.value);
                        if (storeItemsQuery.value) qs.set('q', storeItemsQuery.value);
                        qs.set('limit', '50');
                        qs.set('offset', '0');
                        const res = await authFetch(`/api/admin/store/items?${qs.toString()}`);
                        const data = await res.json();
                        storeItemsTotal.value = data?.total || 0;
                        storeItems.value = Array.isArray(data?.data) ? data.data : [];
                    } catch (e) {
                        console.error(e);
                        storeItems.value = [];
                        storeItemsTotal.value = 0;
                    }
                };

                const saveStoreItem = async (it) => {
                    try {
                        const payload = {
                            title: (it.title || '').trim(),
                            description: (it.description === undefined ? undefined : (it.description || '').trim()),
                            category_id: it.category_id === null || it.category_id === undefined || it.category_id === '' ? null : parseInt(it.category_id, 10),
                            price: parseFloat(it.price || 0),
                            is_active: !!it.is_active
                        };
                        const res = await authFetch(`/api/admin/store/items/${it.id}`, {
                            method: 'PATCH',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        if (res.ok) {
                            triggerToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿπŸÜÿµÿ±');
                            fetchStoreItems();
                        } else {
                            const err = await res.json();
                            triggerToast(err?.detail || 'ŸÅÿ¥ŸÑ ÿßŸÑÿ≠ŸÅÿ∏');
                        }
                    } catch (e) {
                        triggerToast('ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ≠ŸÅÿ∏');
                    }
                };

                const closeStoreItemEditor = () => {
                    try {
                        if (storeItemPreviewUrl.value) URL.revokeObjectURL(storeItemPreviewUrl.value);
                    } catch (e) {}
                    storeItemPreviewUrl.value = '';
                    storeItemPreviewLoading.value = false;
                    storeItemEdit.value = null;
                    storeItemEditTargetId.value = null;
                    showStoreItemEditor.value = false;
                };

                const openStoreItemEditor = async (it) => {
                    try {
                        storeItemEditTargetId.value = it?.id;
                        storeItemEdit.value = JSON.parse(JSON.stringify(it || {}));
                        showStoreItemEditor.value = true;
                        storeItemPreviewUrl.value = '';
                        storeItemPreviewLoading.value = true;
                        const res = await authFetch(`/api/admin/store/items/${it.id}/preview`);
                        if (res.ok) {
                            const blob = await res.blob();
                            storeItemPreviewUrl.value = URL.createObjectURL(blob);
                        }
                    } catch (e) {
                        triggerToast('ŸÅÿ¥ŸÑ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖÿπÿßŸäŸÜÿ©');
                    } finally {
                        storeItemPreviewLoading.value = false;
                    }
                };

                const saveStoreItemFromEditor = async () => {
                    if (!storeItemEdit.value) return;
                    const id = storeItemEditTargetId.value;
                    await saveStoreItem(storeItemEdit.value);
                    const idx = storeItems.value.findIndex(x => x.id === id);
                    if (idx >= 0) {
                        storeItems.value[idx] = { ...storeItems.value[idx], ...storeItemEdit.value };
                    }
                    closeStoreItemEditor();
                };

                const deleteStoreItem = async (it) => {
                    try {
                        if (!it?.id) return;
                        if (!confirm(`ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ #${it.id}ÿü`)) return;
                        const res = await authFetch(`/api/admin/store/items/${it.id}`, { method: 'DELETE' });
                        const raw = await res.text();
                        let data = {};
                        try { data = raw ? JSON.parse(raw) : {}; } catch { data = { detail: raw }; }
                        if (res.ok) {
                            triggerToast('ÿ™ŸÖ ÿßŸÑÿ≠ÿ∞ŸÅ');
                            storeItems.value = storeItems.value.filter(x => x.id !== it.id);
                            storeItemsTotal.value = Math.max(0, (storeItemsTotal.value || 0) - 1);
                        } else {
                            triggerToast(data.detail || `ŸÅÿ¥ŸÑ ÿßŸÑÿ≠ÿ∞ŸÅ (${res.status})`);
                        }
                    } catch (e) {
                        triggerToast('ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ≠ÿ∞ŸÅ');
                    }
                };


                const fetchStorePurchases = async () => {
                    try {
                        const qs = new URLSearchParams();
                        if (storePurchasesFilters.value.user_id) qs.set('user_id', storePurchasesFilters.value.user_id);
                        if (storePurchasesFilters.value.item_id) qs.set('item_id', storePurchasesFilters.value.item_id);
                        qs.set('limit', '100');
                        qs.set('offset', '0');
                        const res = await authFetch(`/api/admin/store/purchases?${qs.toString()}`);
                        const data = await res.json();
                        storePurchasesTotal.value = data?.total || 0;
                        storePurchases.value = Array.isArray(data?.data) ? data.data : [];
                    } catch (e) {
                        console.error(e);
                        storePurchases.value = [];
                        storePurchasesTotal.value = 0;
                    }
                };

                const fetchChangelogs = async () => {
                    try {
                        const res = await authFetch('/api/changelogs');
                        const data = await res.json();
                        changelogs.value = Array.isArray(data) ? data : [];
                    } catch(e) { 
                        console.error(e); 
                        changelogs.value = [];
                    }
                };

                const openDetails = async (log) => {
                    try {
                        const res = await authFetch(`/api/history/${log.id}`);
                        selectedLog.value = await res.json();
                        detailsModal.value = true;
                        detailTab.value = 'summary';
                    } catch (e) { console.error(e); }
                };

                const copyToClipboard = (text) => {
                    navigator.clipboard.writeText(text);
                    triggerToast('Copied to clipboard!');
                };

                const saveLogDetails = () => {
                    if (!selectedLog.value) return;
                    const blob = new Blob([JSON.stringify(selectedLog.value, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `log-${selectedLog.value.id}-${selectedLog.value.timestamp}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    triggerToast('Log saved!');
                };

                const openEditResend = () => {
                    if (!selectedLog.value) return;
                    resendBody.value = formatBody(selectedLog.value.request.body);
                    showEditResendModal.value = true;
                };

                const submitResend = async () => {
                    if (!selectedLog.value) return;
                    try {
                        const res = await authFetch(`/api/history/${selectedLog.value.id}/resend`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ new_body: resendBody.value })
                        });
                        
                        if (!res.ok) throw new Error('Failed to resend request');
                        
                        const data = await res.json();
                        triggerToast(`Request Resent! Status: ${data.http_code}`);
                        showEditResendModal.value = false;
                        detailsModal.value = false;
                        fetchStats(); 
                    } catch (e) {
                        triggerToast('Error resending request');
                        console.error(e);
                    }
                };

                const formatBody = (body) => {
                    if (!body) return '';
                    try {
                        // If it's already an object, stringify it
                        if (typeof body === 'object') return JSON.stringify(body, null, 2);
                        // If it's a string, try to parse and stringify
                        const parsed = JSON.parse(body);
                        return JSON.stringify(parsed, null, 2);
                    } catch (e) {
                        return body;
                    }
                };

                // Watch for tab changes in modal to trigger Prism highlight
                Vue.watch(detailTab, () => {
                    nextTick(() => {
                        Prism.highlightAll();
                    });
                });
                
                // Watch for modal open to trigger Prism highlight
                Vue.watch(detailsModal, (newVal) => {
                    if (newVal) {
                        nextTick(() => {
                            Prism.highlightAll();
                            lucide.createIcons();
                        });
                    }
                });

                const fetchGames = async () => {
                    try {
                        const res = await authFetch('/api/games');
                        const data = await res.json();
                        games.value = Array.isArray(data) ? data : [];
                    } catch (e) { 
                        console.error(e); 
                        games.value = [];
                    }
                };

                const fetchUsers = async () => {
                    try {
                        const res = await authFetch('/api/users');
                        const data = await res.json();
                        users.value = Array.isArray(data) ? data : [];
                    } catch (e) { 
                        console.error(e); 
                        users.value = [];
                    }
                };

                const fetchChatConversations = async () => {
                    try {
                        const res = await authFetch('/api/chat/conversations');
                        const data = await res.json();
                        chatConversations.value = Array.isArray(data) ? data.filter(c => c.kind === 'user_admin') : [];
                    } catch (e) {
                        console.error(e);
                        chatConversations.value = [];
                    }
                };

                const fetchChatMessages = async (conversationId) => {
                    try {
                        const res = await authFetch(`/api/chat/conversations/${conversationId}/messages`);
                        const data = await res.json();
                        chatMessages.value = Array.isArray(data) ? data : [];
                        nextTick(() => {
                            const el = document.getElementById('chat-scroll-anchor');
                            if (el) el.scrollIntoView({ behavior: 'smooth', block: 'end' });
                        });
                    } catch (e) {
                        console.error(e);
                        chatMessages.value = [];
                    }
                };

                const openChatConversation = async (conv) => {
                    chatSelectedConversation.value = conv;
                    chatNewMessage.value = '';
                    await fetchChatMessages(conv.id);
                };

                const sendChatMessage = async () => {
                    if (!chatSelectedConversation.value) return;
                    const body = chatNewMessage.value.trim();
                    if (!body) return;
                    try {
                        await authFetch(`/api/chat/conversations/${chatSelectedConversation.value.id}/messages`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ body })
                        });
                        chatNewMessage.value = '';
                        await fetchChatConversations();
                        await fetchChatMessages(chatSelectedConversation.value.id);
                    } catch (e) {
                        console.error(e);
                        triggerToast('Error sending message');
                    }
                };

                const fetchArchive = async () => {
                    try {
                        const params = new URLSearchParams();
                        params.set('offset', String(archiveOffset.value));
                        params.set('limit', String(archiveLimit.value));
                        if (archiveFilters.value.q) params.set('q', archiveFilters.value.q);
                        if (archiveFilters.value.user_id) params.set('user_id', String(archiveFilters.value.user_id));
                        if (archiveFilters.value.game) params.set('game', archiveFilters.value.game);
                        if (archiveFilters.value.platform) params.set('platform', archiveFilters.value.platform);
                        if (archiveFilters.value.event) params.set('event', archiveFilters.value.event);
                        if (archiveFilters.value.status_code) params.set('status_code', String(archiveFilters.value.status_code));
                        if (archiveFilters.value.from_ts) params.set('from_ts', archiveFilters.value.from_ts);
                        if (archiveFilters.value.to_ts) params.set('to_ts', archiveFilters.value.to_ts);

                        const res = await authFetch(`/api/history/search?${params.toString()}`);
                        const data = await res.json();
                        archiveItems.value = Array.isArray(data?.items) ? data.items : [];
                        archiveTotal.value = typeof data?.total === 'number' ? data.total : 0;
                    } catch (e) {
                        console.error(e);
                        archiveItems.value = [];
                        archiveTotal.value = 0;
                    }
                };

                const applyArchiveFilters = () => {
                    archiveOffset.value = 0;
                    fetchArchive();
                };

                const resetArchiveFilters = () => {
                    archiveFilters.value = { q: '', user_id: '', game: '', platform: '', event: '', status_code: '', from_ts: '', to_ts: '' };
                    archiveOffset.value = 0;
                    fetchArchive();
                };

                const archivePrev = () => {
                    archiveOffset.value = Math.max(0, archiveOffset.value - archiveLimit.value);
                    fetchArchive();
                };

                const archiveNext = () => {
                    if (archiveOffset.value + archiveLimit.value >= archiveTotal.value) return;
                    archiveOffset.value += archiveLimit.value;
                    fetchArchive();
                };
                
                const filteredUsers = Vue.computed(() => {
                    const list = Array.isArray(users.value) ? users.value : [];
                    if (!headerSearch.value) return list;
                    const q = headerSearch.value.toLowerCase();
                    return list.filter(u => 
                        u.id.toString().includes(q) || 
                        (u.gaid && u.gaid.toLowerCase().includes(q))
                    );
                });

                const filteredGames = Vue.computed(() => {
                    const list = Array.isArray(games.value) ? games.value : [];
                    if (filterScope.value === 'all') return list;
                    if (filterScope.value === 'global') return list.filter(g => !g.owner_id);
                    if (filterScope.value === 'private') return list.filter(g => g.owner_id);
                    return list;
                });

                const fetchPrice = async () => {
                    try {
                        const res = await authFetch('/api/settings/price');
                        const data = await res.json();
                        priceForm.value.amount = data.price;
                    } catch(e) { console.error(e); }
                };

                const selectedTimelineGame = ref(null);
                const timelineSteps = ref([]);

                const fetchGameTimelines = async () => {
                    if(!selectedTimelineGame.value) return;
                    try {
                        const res = await authFetch(`/api/games/${selectedTimelineGame.value}/timelines`);
                        timelineSteps.value = await res.json();
                    } catch(e) { console.error(e); }
                };

                const addTimelineStep = () => {
                    if(!timelineForm.value.step_name || !timelineForm.value.event_value) {
                        triggerToast('Name and Value are required');
                        return;
                    }
                    timelineSteps.value.push({ ...timelineForm.value });
                    timelineForm.value = { step_name: '', event_value: '', day_offset: 0, hour_offset: 0 };
                };

                const removeTimelineStep = (index) => {
                    timelineSteps.value.splice(index, 1);
                };

                const saveTimelines = async () => {
                    if(!selectedTimelineGame.value) return;
                    try {
                        await authFetch(`/api/games/${selectedTimelineGame.value}/timelines`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ steps: timelineSteps.value })
                        });
                        triggerToast('Timelines saved successfully!');
                    } catch(e) { triggerToast('Error saving timelines'); }
                };

                const setPrice = async () => {
                    try {
                        await authFetch('/api/settings/price', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ price: priceForm.value.amount })
                        });
                        triggerToast('Price updated!');
                    } catch(e) { triggerToast('Error updating price'); }
                };

                const toggleGame = async (id) => {
                    await authFetch(`/api/game/toggle/${id}`, { method: 'POST' });
                    fetchGames();
                    fetchStats();
                };

                const promoteGame = async (gameId) => {
                    if (!confirm(t('promote_confirm'))) return;
                    try {
                        const res = await authFetch(`/api/games/${gameId}/promote`, { method: 'POST' });
                        if (res.ok) {
                            triggerToast(t('promote_success'));
                            fetchGames();
                        } else {
                            triggerToast('Error promoting game');
                        }
                    } catch (e) {
                        console.error(e);
                        triggerToast('Error promoting game');
                    }
                };

                const addGame = async () => {
                    // Validation
                    if (!newGame.value.name || !newGame.value.package_name || !newGame.value.main_key) {
                        triggerToast(t('validation_required'));
                        return;
                    }

                    if (newGame.value.provider === 'AppsFlyer' && newGame.value.main_key.length < 5) {
                        triggerToast(t('validation_appsflyer_len'));
                        return;
                    }
                    if (newGame.value.provider === 'Adjust') {
                        const token = newGame.value.main_key;
                        if (token.length !== 12 || !/^[a-z0-9]+$/i.test(token)) {
                            triggerToast(t('validation_adjust_len'));
                            return;
                        }
                    }
                    if (newGame.value.provider === 'Singular' && newGame.value.main_key.length < 20) {
                        triggerToast(t('validation_singular_len'));
                        return;
                    }

                    try {
                        await authFetch('/api/games', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(newGame.value)
                        });
                        showAddGameModal.value = false;
                        newGame.value = { name: '', package_name: '', provider: 'AppsFlyer', device_os: 'android', main_key: '', advanced_data: '', price: 0 };
                        fetchGames();
                        triggerToast('Game added successfully!');
                    } catch(e) { triggerToast('Error adding game'); }
                };

                const openEditGameModal = (game) => {
                    const config = game.json_data || {};
                    let events = [];
                    
                    // Parse events based on provider structure
                    if (game.provider === 'Adjust') {
                        const tokens = config.event_tokens || {};
                        events = Object.entries(tokens).map(([k, v]) => ({ name: k, token: v }));
                    } else {
                        // For AF/Singular, try to simplify event_templates or just show empty if complex
                        // Only simple string mappings are shown in list, complex objects stay in JSON
                        const templates = config.event_templates || {};
                        events = Object.entries(templates)
                            .filter(([k, v]) => typeof v === 'string')
                            .map(([k, v]) => ({ name: k, token: v }));
                    }

                    editGameData.value = {
                        id: game.id,
                        name: game.name,
                        alias: game.alias,
                        package_name: game.package_name,
                        provider: game.provider,
                        json_configuration: JSON.stringify(config, null, 2),
                        is_active: game.is_active,
                        price: game.price || 0,
                        // Config fields
                        config_app_id: config.app_id || config.app_token || game.package_name,
                        config_dev_key: config.dev_key || '',
                        config_api_key: config.api_key || config.a || '',
                        config_environment: config.environment || 'production',
                        config_events: events,
                        owner_id: game.owner_id
                    };
                    showEditGameModal.value = true;
                };

                const addEventRow = () => {
                    editGameData.value.config_events.push({ name: '', token: '' });
                };

                const removeEventRow = (idx) => {
                    editGameData.value.config_events.splice(idx, 1);
                };

                const updateGame = async () => {
                    try {
                        // Merge config fields back into JSON
                        let currentConfig = {};
                        try {
                            currentConfig = JSON.parse(editGameData.value.json_configuration);
                        } catch (e) {
                            triggerToast('Invalid JSON in Advanced Configuration');
                            return;
                        }

                        // Update common fields
                        if (editGameData.value.provider === 'Adjust') {
                            currentConfig.app_token = editGameData.value.config_app_id;
                            currentConfig.environment = editGameData.value.config_environment;
                            
                            // Rebuild event_tokens
                            const tokens = {};
                            editGameData.value.config_events.forEach(e => {
                                if(e.name && e.token) tokens[e.name] = e.token;
                            });
                            currentConfig.event_tokens = tokens;
                            
                        } else if (editGameData.value.provider === 'AppsFlyer') {
                            currentConfig.app_id = editGameData.value.config_app_id;
                            currentConfig.dev_key = editGameData.value.config_dev_key;
                            
                            // Merge simple events back to templates
                            if (!currentConfig.event_templates) currentConfig.event_templates = {};
                            editGameData.value.config_events.forEach(e => {
                                if(e.name && e.token) currentConfig.event_templates[e.name] = e.token;
                            });

                        } else if (editGameData.value.provider === 'Singular') {
                            currentConfig.app_id = editGameData.value.config_app_id;
                            currentConfig.api_key = editGameData.value.config_api_key; // a param
                            
                             // Merge simple events back
                            if (!currentConfig.event_templates) currentConfig.event_templates = {};
                            editGameData.value.config_events.forEach(e => {
                                if(e.name && e.token) currentConfig.event_templates[e.name] = e.token;
                            });
                        }

                        // Update JSON string to reflect merges (for backend)
                        editGameData.value.json_configuration = JSON.stringify(currentConfig);

                        const res = await authFetch(`/api/games/${editGameData.value.id}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(editGameData.value)
                        });
                        
                        if (res.ok) {
                            triggerToast(t('game_updated'));
                            showEditGameModal.value = false;
                            fetchGames();
                        } else {
                            triggerToast(t('error_updating_game'));
                        }
                    } catch (e) {
                        triggerToast(e.message);
                    }
                };

                const deleteGame = async (gameId) => {
                    if (!confirm(t('delete_game_confirm'))) return;
                    
                    try {
                        const res = await authFetch(`/api/games/${gameId}`, {
                            method: 'DELETE'
                        });
                        
                        if (res.ok) {
                            triggerToast(t('game_deleted'));
                            fetchGames();
                        } else {
                            triggerToast(t('error_deleting_game'));
                        }
                    } catch (e) {
                        triggerToast(e.message);
                    }
                };

                const changePassword = async () => {
                    if (passwordForm.value.new_password !== passwordForm.value.confirm_password) {
                        triggerToast(t('passwords_no_match'));
                        return;
                    }
                    try {
                        await authFetch('/api/auth/password', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                current_password: passwordForm.value.current_password,
                                new_password: passwordForm.value.new_password
                            })
                        });
                        showChangePasswordModal.value = false;
                        passwordForm.value = { current_password: '', new_password: '', confirm_password: '' };
                        triggerToast(t('password_changed'));
                    } catch(e) { triggerToast(t('error_changing_password')); }
                };

                const openBalanceModal = (user) => {
                    selectedUser.value = user;
                    showBalanceModal.value = true;
                };

                const addBalance = async () => {
                    try {
                        await authFetch(`/api/users/${selectedUser.value.id}/balance`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(balanceForm.value)
                        });
                        showBalanceModal.value = false;
                        balanceForm.value = { amount: 0 };
                        fetchUsers();
                        triggerToast('Balance added!');
                    } catch(e) { triggerToast('Error adding balance'); }
                };

                const generateCoupon = async () => {
                    try {
                        const res = await authFetch('/api/coupons', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(couponForm.value)
                        });
                        const data = await res.json();
                        copyToClipboard(data.code);
                        triggerToast('Coupon generated & copied!');
                    } catch(e) { triggerToast('Error generating coupon'); }
                };

                const sendBroadcast = async () => {
                    try {
                        await authFetch('/api/broadcast', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ message: broadcastMsg.value })
                        });
                        broadcastMsg.value = '';
                        triggerToast('Broadcast sent!');
                    } catch(e) { triggerToast('Error sending broadcast'); }
                };

                const triggerBackup = async () => {
                    loading.value = true;
                    try {
                        await authFetch('/api/backup', { method: 'POST' });
                        triggerToast('Backup started!');
                    } catch(e) { triggerToast('Error starting backup'); }
                    finally { loading.value = false; }
                };

                const downloadBackup = async () => {
                    loading.value = true;
                    try {
                        const res = await authFetch('/api/backup/download');
                        const blob = await res.blob();
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = 'KUN_Backup.zip';
                        document.body.appendChild(a);
                        a.click();
                        a.remove();
                        window.URL.revokeObjectURL(url);
                        triggerToast(t('download_backup'));
                    } catch(e) { triggerToast('Error downloading backup'); }
                    finally { loading.value = false; }
                };

                // Health
                const health = Vue.reactive({ data: null });
                const fetchHealth = async () => {
                    try {
                        const res = await authFetch('/api/health');
                        const data = await res.json();
                        health.data = data.data || null;
                    } catch (e) { console.error(e); }
                };

                // Maintenance
                const maintenance = Vue.reactive({ enabled: false });
                const fetchMaintenance = async () => {
                    try {
                        const res = await authFetch('/api/maintenance');
                        const data = await res.json();
                        maintenance.enabled = !!data.enabled;
                    } catch (e) { console.error(e); }
                };
                const toggleMaintenance = async (enabled) => {
                    try {
                        await authFetch('/api/maintenance', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ enabled })
                        });
                        maintenance.enabled = !!enabled;
                        triggerToast(t('save_settings'));
                    } catch (e) { triggerToast('Error toggling maintenance'); }
                };

                // Audit
                const audit = Vue.reactive({ items: [] });
                const fetchAudit = async () => {
                    try {
                        const res = await authFetch('/api/audit');
                        const data = await res.json();
                        audit.items = data.data || [];
                    } catch (e) { console.error(e); }
                };

                const formatLog = (msg) => {
                    // Simple color formatting for logs
                    if(msg.includes('Error') || msg.includes('Fail')) return `<span class="text-red-400">${msg}</span>`;
                    if(msg.includes('Success') || msg.includes('‚úÖ')) return `<span class="text-green-400">${msg}</span>`;
                    if(msg.includes('Warning') || msg.includes('‚ö†Ô∏è')) return `<span class="text-yellow-400">${msg}</span>`;
                    return msg;
                };

                // --- Bot Management Functions ---
                const fetchBotTokens = async () => {
                    try {
                        const res = await authFetch('/api/bot/tokens');
                        botTokens.value = await res.json();
                    } catch (e) { console.error(e); }
                };

                const fetchBotAccess = async () => {
                    try {
                        const res = await authFetch('/api/bot/access');
                        botAccessList.value = await res.json();
                    } catch (e) { console.error(e); }
                };

                const addBotToken = async () => {
                    if (!newToken.value.name || !newToken.value.token) {
                        triggerToast(t('validation_required'));
                        return;
                    }
                    try {
                        const res = await authFetch('/api/bot/tokens', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(newToken.value)
                        });
                        
                        if (!res.ok) {
                            const data = await res.json();
                            throw new Error(data.detail || t('error_adding_token'));
                        }
                        
                        triggerToast(t('token_added'));
                        showAddTokenModal.value = false;
                        newToken.value = { name: '', token: '' };
                        fetchBotTokens();
                    } catch (e) { 
                        triggerToast(e.message || t('error_adding_token')); 
                    }
                };

                const deleteBotToken = async (id) => {
                    if (!confirm(t('delete_token_confirm'))) return;
                    try {
                        await authFetch(`/api/bot/tokens/${id}`, { method: 'DELETE' });
                        triggerToast(t('token_deleted'));
                        fetchBotTokens();
                    } catch (e) { triggerToast('Error deleting token'); }
                };

                const addBotAccess = async () => {
                    if (!newAccess.value.user_id) {
                        triggerToast(t('validation_required'));
                        return;
                    }
                    try {
                        const res = await authFetch('/api/bot/access', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(newAccess.value)
                        });
                        if (!res.ok) throw new Error();

                        triggerToast(t('access_added'));
                        showAddAccessModal.value = false;
                        newAccess.value = { user_id: '', role: 'editor', name: '' };
                        fetchBotAccess();
                    } catch (e) { triggerToast(t('error_adding_access')); }
                };

                const deleteBotAccess = async (id) => {
                    if (!confirm(t('delete_access_confirm'))) return;
                    try {
                        await authFetch(`/api/bot/access/${id}`, { method: 'DELETE' });
                        triggerToast(t('access_deleted'));
                        fetchBotAccess();
                    } catch (e) { triggerToast('Error removing access'); }
                };

                const initData = () => {
                    fetchStats();
                    fetchGames();
                    fetchUsers();
                    fetchPrice();
                    fetchPlatformSettings();
                    fetchChangelogs();
                    if (currentUser.value?.role === 'admin') {
                        fetchRequestPrice();
                        fetchBotTokens();
                        fetchBotAccess();
                        fetchGlobalProxies();
                        fetchNetworkStatus();
                    }
                    if(socket) socket.close();
                    initWebSocket();
                };

                const initWebSocket = () => {
                    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                    socket = new WebSocket(`${protocol}//${window.location.host}/ws/logs`);
                    
                    socket.onmessage = (event) => {
                        liveLogs.value.unshift(event.data);
                        if (liveLogs.value.length > 500) liveLogs.value.pop();
                        
                        nextTick(() => {
                            const container = document.getElementById('log-container');
                            if(container) container.scrollTop = container.scrollHeight;
                        });
                    };
                    
                    socket.onclose = () => {
                        setTimeout(initWebSocket, 3000);
                    };
                };

                const coupons = ref([]);
                // Finance State
                const financeTab = ref('stats');
                const financeStats = ref({});
                const transactions = ref([]);
                const financeFilters = ref({ user_id: '', type: '' });
                const walletResetPassword = ref('');
                const expensesResetPassword = ref('');
                const requestPrice = ref(0);
                const newCoupon = ref({ code: '', amount: 0 });

                const fetchFinanceStats = async () => {
                    try {
                        const res = await authFetch('/api/admin/finance/stats');
                        if(res.ok) financeStats.value = await res.json();
                    } catch(e) { console.error(e); }
                };

                const fetchTransactions = async () => {
                    try {
                        const params = new URLSearchParams();
                        if(financeFilters.value.user_id) params.append('user_id', financeFilters.value.user_id);
                        if(financeFilters.value.type) params.append('type', financeFilters.value.type);
                        
                        const res = await authFetch(`/api/admin/transactions?${params.toString()}`);
                        if(res.ok) {
                            const data = await res.json();
                            transactions.value = Array.isArray(data.data) ? data.data : [];
                        }
                    } catch(e) { console.error(e); }
                };

                const createCoupon = async () => {
                    if(!newCoupon.value.amount || newCoupon.value.amount <= 0) {
                        triggerToast('Invalid amount');
                        return;
                    }
                    try {
                        const res = await authFetch('/api/admin/coupons', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({ code: newCoupon.value.code || null, amount: newCoupon.value.amount })
                        });
                        if(res.ok) {
                            const data = await res.json();
                            triggerToast(`Coupon created: ${data.code}`);
                            newCoupon.value = { code: '', amount: 0 };
                            fetchCoupons();
                            fetchFinanceStats();
                        } else {
                            triggerToast('Error creating coupon');
                        }
                    } catch(e) { triggerToast('Error creating coupon'); }
                };

                const resetWallets = async () => {
                    if(!walletResetPassword.value) return;
                    if(!confirm('ARE YOU SURE? This will reset ALL user wallets to 0!')) return;
                    
                    try {
                        const res = await authFetch('/api/admin/finance/reset-wallets', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({ password: walletResetPassword.value })
                        });
                        
                        if(res.ok) {
                            triggerToast('All wallets have been reset.');
                            walletResetPassword.value = '';
                            fetchFinanceStats();
                            fetchStats(); // Refresh global stats
                        } else {
                            const err = await res.json();
                            triggerToast(err.detail || 'Reset failed');
                        }
                    } catch(e) { triggerToast('Error resetting wallets'); }
                };

                const resetExpenses = async () => {
                    if(!expensesResetPassword.value) return;
                    if(!confirm('ARE YOU SURE? This will reset Total Withdrawals counter only.')) return;
                    try {
                        const res = await authFetch('/api/admin/finance/reset-expenses', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({ password: expensesResetPassword.value })
                        });
                        if(res.ok) {
                            triggerToast('Total Withdrawals counter reset.');
                            expensesResetPassword.value = '';
                            fetchFinanceStats();
                            fetchTransactions();
                        } else {
                            let detail = '';
                            try {
                                const err = await res.json();
                                detail = err?.detail || '';
                            } catch (e) {
                                try { detail = (await res.text()) || ''; } catch (e2) { detail = ''; }
                            }
                            if (res.status === 404) {
                                triggerToast('ÿßŸÑŸÖÿ≥ÿßÿ± ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ (ÿ£ÿπÿØ ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿÆÿßÿØŸÖ)');
                            } else {
                                triggerToast(detail || `Reset failed (${res.status})`);
                            }
                        }
                    } catch(e) { triggerToast('Error resetting expenses'); }
                };

                const fetchRequestPrice = async () => {
                    try {
                        const res = await authFetch('/api/admin/finance/request-price');
                        const data = await res.json();
                        requestPrice.value = data.price || 0;
                    } catch(e) { console.error(e); }
                };

                const saveRequestPrice = async () => {
                    try {
                        const res = await authFetch('/api/admin/finance/request-price', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({ amount: parseFloat(requestPrice.value) })
                        });
                        if(res.ok) {
                            triggerToast('Request price updated');
                        }
                    } catch(e) { triggerToast('Error updating price'); }
                };

                const fetchCoupons = async () => {
                    try {
                        const res = await authFetch('/api/admin/coupons');
                        const data = await res.json();
                        coupons.value = Array.isArray(data) ? data : [];
                    } catch (e) { console.error(e); }
                };

                const deleteCoupon = async (code) => {
                    if(!confirm('Delete this coupon?')) return;
                    try {
                        await authFetch(`/api/admin/coupons/${code}`, { method: 'DELETE' });
                        fetchCoupons();
                        triggerToast('Coupon deleted');
                    } catch(e) { triggerToast('Error deleting coupon'); }
                };

                const banUser = async (id) => {
                    if(!confirm('Ban this user?')) return;
                    try {
                        await authFetch(`/api/users/${id}/ban`, { method: 'POST' });
                        fetchUsers();
                        triggerToast('User banned');
                    } catch(e) { triggerToast('Error banning user'); }
                };

                const unbanUser = async (id) => {
                    try {
                        await authFetch(`/api/users/${id}/unban`, { method: 'POST' });
                        fetchUsers();
                        triggerToast('User unbanned');
                    } catch(e) { triggerToast('Error unbanning user'); }
                };

                const addBalanceManual = async () => {
                    if(!manualBalanceForm.value.user_id || !manualBalanceForm.value.amount) {
                        triggerToast('User ID and Amount required');
                        return;
                    }
                    try {
                        await authFetch(`/api/users/${manualBalanceForm.value.user_id}/balance`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ amount: parseFloat(manualBalanceForm.value.amount) })
                        });
                        manualBalanceForm.value = { user_id: '', amount: '' };
                        fetchUsers();
                        triggerToast('Balance added successfully!');
                    } catch(e) { triggerToast('Error adding balance'); }
                };

                const addBalanceToAll = async () => {
                    try {
                        await authFetch('/api/users/add-balance-all', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ amount: addBalanceAllAmount.value })
                        });
                        showAddBalanceAllModal.value = false;
                        addBalanceAllAmount.value = 0;
                        fetchUsers();
                        triggerToast(t('balance_added_success'));
                    } catch(e) { triggerToast('Error adding balance to all users'); }
                };

                onMounted(() => {
                    checkAuth();
                    lucide.createIcons();
                    document.documentElement.dir = currentLang.value === 'ar' ? 'rtl' : 'ltr';
                    setInterval(() => {
                        if(token.value) fetchStats();
                    }, 10000); 
                });

                // Re-render icons on tab change
                const watchTab = Vue.watch(currentTab, () => {
                    nextTick(() => lucide.createIcons());
                    if (currentTab.value === 'games') fetchGames();
                    if (currentTab.value === 'users') fetchUsers();
                    if (currentTab.value === 'archive') fetchArchive();
                    if (currentTab.value === 'finance') {
                        fetchFinanceStats();
                        fetchTransactions();
                        fetchCoupons();
                        fetchRequestPrice();
                    }
                    if (currentTab.value === 'store' && currentUser.value?.role === 'admin') {
                        fetchStoreChannels();
                        fetchStoreChannelsLog();
                        fetchStoreCategories();
                        fetchStoreItems();
                        fetchStorePurchases();
                    }
                    if (currentTab.value === 'chat') fetchChatConversations();
                    if (currentTab.value === 'bot_mgmt' && currentUser.value?.role === 'admin') {
                        fetchBotTokens();
                        fetchBotAccess();
                    }
                    if (currentTab.value === 'admin' && currentUser.value?.role === 'admin') {
                        fetchHealth();
                        fetchMaintenance();
                        fetchAudit();
                    }
                });

                return {
                    sidebarOpen,
                    currentTab, stats, games, history, liveLogs, users, filteredUsers,
                    filterScope, filteredGames,
                    archiveItems, archiveTotal, archiveOffset, archiveLimit, archiveFilters,
                    fetchArchive, applyArchiveFilters, resetArchiveFilters, archivePrev, archiveNext,
                    detailsModal, showAddGameModal, showEditGameModal, showBalanceModal, selectedLog, selectedUser,
                    detailTab, rawView, headerSearch, toastMsg, showToast, loading,
                    newGame, editGameData, balanceForm, couponForm, timelineForm, priceForm, broadcastMsg,
                    showAddBalanceAllModal, addBalanceAllAmount, addBalanceToAll,
                    showEditResendModal, resendBody, openEditResend, submitResend,
                    selectedTimelineGame, timelineSteps, coupons,
                    botTokens, botAccessList, showAddTokenModal, showAddAccessModal, newToken, newAccess,
                    fetchBotTokens, fetchBotAccess, addBotToken, deleteBotToken, addBotAccess, deleteBotAccess,
                    fetchStats, toggleGame, promoteGame, formatLog, openDetails, copyToClipboard, saveLogDetails, formatBody,
                    addGame, openEditGameModal, updateGame, deleteGame, openBalanceModal, addBalance, addBalanceManual, generateCoupon, fetchCoupons, deleteCoupon, banUser, unbanUser,
                    fetchGameTimelines, addTimelineStep, removeTimelineStep, saveTimelines,
                    setPrice, sendBroadcast, triggerBackup, downloadBackup, manualBalanceForm,
                    chatConversations, chatSelectedConversation, chatMessages, chatNewMessage,
                    fetchChatConversations, fetchChatMessages, openChatConversation, sendChatMessage,
                    // Auth & Lang
                    currentLang, currentUser, showLoginModal, showChangePasswordModal, loginForm, passwordForm, loginError,
                    login, logout, changePassword, setLang, t,
                    // Platform Settings
                    platformSettings, fetchPlatformSettings, savePlatformSettings,
                    globalProxiesText, networkStatus, fetchNetworkStatus, fetchGlobalProxies, saveGlobalProxies,
                    importProxies,
                    storeTab, storeChannelsText, storeChannelsCurrent, storeChannelsLog, storeCategories, storeNewCategory,
                    storeItemsStatus, storeItemsQuery, storeItemsTotal, storeItems,
                    showStoreItemEditor, storeItemEdit, storeItemPreviewUrl, storeItemPreviewLoading,
                    storePurchasesFilters, storePurchasesTotal, storePurchases,
                    fetchStoreChannels, fetchStoreChannelsLog, saveStoreChannels, fetchStoreCategories, createStoreCategory, toggleStoreCategory,
                    fetchStoreItems, saveStoreItem, fetchStorePurchases, scanStoreChannels, testStoreIngest,
                    openStoreItemEditor, closeStoreItemEditor, saveStoreItemFromEditor, deleteStoreItem,
                    changelogs, fetchChangelogs,
                    // Finance
                    financeTab, financeStats, transactions, financeFilters, walletResetPassword, expensesResetPassword, requestPrice, newCoupon,
                    fetchFinanceStats, fetchTransactions, createCoupon, resetWallets, resetExpenses, saveRequestPrice,
                    // Admin tools
                    health, fetchHealth, maintenance, fetchMaintenance, toggleMaintenance, audit, fetchAudit
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
